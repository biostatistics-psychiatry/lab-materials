{
  "hash": "ff342e1d683e101fbc1d6275eaf3350a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Testing two means\nnumber-sections: true\nformat: live-html\nengine: knitr\nwebr:\n  packages:\n    - dplyr\n    - tableone\nresources:\n  - ../data/steps_clean.csv\n---\n\n::: {.cell}\n\n:::\n\n::: {.cell setup='true' exercise='ex_1'}\n```{webr}\n#| setup: true\n#| exercise: ex_1\n# Load the CSV data\nlibrary(dplyr)\ndf_data <- read.csv(\"data/steps_clean.csv\")\n```\n:::\n\n\n\n\n::::: panel-tabset\n## Exercise 1\n\nCalculate the mean difference in post-treatment LSAS scores, and the associated two-sided p-value for the mean difference between the therapist-guided and the wait list group\n\n\n\n::: {.cell exercise='ex_1'}\n```{webr}\n#| exercise: ex_1\n\n```\n:::\n\n\n\n## Hints\n\n::: {.hint exercise=\"ex_1\"}\nYou can calculate it using the `t.test()` function\n``` r\ndf_data %>%\n  filter(trt != \"_____\") %>%\n  t.test(______ ~ trt, data = ., var.equal = TRUE)\n```\n\nOr if you want to do it manually, you can use the following formulas\n\nTo test the difference between two means, we can use the Student's independent groups t-test:\n\n$$\nt = \\frac{\\bar{X}_1 - \\bar{X}_2}{SE_{\\text{pooled}}}\n$$\n\nWhere $\\bar{X_1}$ and $\\bar{X_2}$ are the means of the first and second group, and where the pooled standard error is:\n\n$$\nSE_{\\text{pooled}} = \\sqrt{s_p^2 \\left(\\frac{1}{n_1} + \\frac{1}{n_2}\\right)}\n$$\n\nand the pooled variance is:\n\n$$\ns_p^2 = \\frac{(n_1 - 1)s_1^2 + (n_2 - 1)s_2^2}{n_1 + n_2 - 2}\n$$\n\n\n:::\n\n## Solution\n\n::: {.solution exercise=\"ex_1\"}\nThe full solution is:\n\n``` r\n#using the t.test() function\ndf_data %>%\n  filter(trt != \"self-guided\") %>%\n  t.test(lsas_post ~ trt, data = ., var.equal = TRUE)\n\n# or manually\nx_bar_tg <- mean(df_data$lsas_post[df_data$trt==\"therapist-guided\"], na.rm=T)\nx_bar_wl <- mean(df_data$lsas_post[df_data$trt==\"waitlist\"], na.rm=T)\ns_2_tg <- var(df_data$lsas_post[df_data$trt==\"therapist-guided\"], na.rm=T)\ns_2_wl <- var(df_data$lsas_post[df_data$trt==\"waitlist\"], na.rm=T)\nn_tg <- sum(!is.na(df_data$lsas_post[df_data$trt==\"therapist-guided\"]))\nn_wl <- sum(!is.na(df_data$lsas_post[df_data$trt==\"waitlist\"]))\nsp2 <- ((n_tg - 1) * s_2_tg + (n_wl - 1) * s_2_wl) / (n_tg + n_wl - 2) # pooled variance\nSE_pooled <- sqrt(sp2 * (1/n_tg + 1/n_wl)) # pooled standard error\n\n# and put the together\nt_value <- (x_bar_wl - x_bar_tg) / SE_pooled\n\n#find the p-value\ndf <- n_tg + n_wl -2 \np_value <- 2 * (1 - pt(abs(t_value), df)) # multiplied by two to get the two-tailed p-value\np_value #<1>\n```\n:::\n:::::\n\n\n\n\n::: {.cell setup='true' exercise='ex_2'}\n```{webr}\n#| setup: true\n#| exercise: ex_2\n# Load the CSV data\nlibrary(dplyr)\ndf_data <- read.csv(\"data/steps_clean.csv\")\n```\n:::\n\n\n\n\n::::: panel-tabset\n## Exercise 2\n\nDo you think the assumption of equal variance between the groups is justified?\n\n\n\n::: {.cell exercise='ex_2'}\n```{webr}\n#| exercise: ex_2\n\n```\n:::\n\n\n\n## Hints\n\n::: {.hint exercise=\"ex_2\"}\nYou can check the variance of each group\n``` r\nvar(df_data$______[df_data$trt==\"_____\"], na.rm=T)\nvar(df_data$_____[df_data$trt==\"therapist-guided\"], na.rm=T)\n```\n\n:::\n\n## Solution\n\n::: {.solution exercise=\"ex_2\"}\nThe full solution is:\n\n``` r\nvar(df_data$lsas_post[df_data$trt==\"waitlist\"], na.rm=T)\nvar(df_data$lsas_post[df_data$trt==\"therapist-guided\"], na.rm=T)\n #<2>\n```\nIn these results show rather similar variances, although not equal\n:::\n:::::\n\n\n\n::: {.cell setup='true' exercise='ex_3'}\n```{webr}\n#| setup: true\n#| exercise: ex_3\n# Load the CSV data\nlibrary(dplyr)\ndf_data <- read.csv(\"data/steps_clean.csv\")\n```\n:::\n\n\n\n\n::::: panel-tabset\n## Exercise 3\n\nHow do the results differ if you use the Welch t-test instead, that does not assume equal variances? \n\n\n\n::: {.cell exercise='ex_3'}\n```{webr}\n#| exercise: ex_3\n\n```\n:::\n\n\n\n## Hints\n\n::: {.hint exercise=\"ex_3\"}\nYou can again calculate it using the `t.test()` function, but need to change the setting of the var.equal argument\n``` r\ndf_data %>%\n  filter(trt != \"_____\") %>%\n  t.test(______ ~ trt, data = ., var.equal = _____)\n```\n:::\n\n## Solution\n\n::: {.solution exercise=\"ex_3\"}\nThe full solution is:\n\n``` r\ndf_data %>%\n  filter(trt != \"self-guided\") %>%\n  t.test(lsas_post ~ trt, data = ., var.equal = FALSE)\n #<3>\n```\nResults are very similar to when the variances where assumed to equal, so the difference in variance between the groups do not 0affect our results to any large degree\n:::\n:::::\n\n\n\n\n::: {.cell setup='true' exercise='ex_4'}\n```{webr}\n#| setup: true\n#| exercise: ex_4\n# Load the CSV data\nlibrary(dplyr)\ndf_data <- read.csv(\"data/steps_clean.csv\")\n```\n:::\n\n\n\n\n::::: panel-tabset\n## Exercise 4\n\nAlso calculate the 95% confidence interval for the difference in LSAS post-treatment scores between the therapist-guided and waitlist group\n\n\n\n::: {.cell exercise='ex_4'}\n```{webr}\n#| exercise: ex_4\n\n```\n:::\n\n\n\n## Hints\n\n::: {.hint exercise=\"ex_4\"}\nYou can again calculate it using the `t.test()` function\n``` r\ndf_data %>%\n  filter(trt != \"_____\") %>%\n  t.test(______ ~ trt, data = ., var.equal = TRUE)\n```\nOr if you want to do it manually, use the formula for the z-score 95% CI of mean differences \n\n$$\n(\\bar{X}_1 - \\bar{X}_2) \\;\\pm\\; z_{\\alpha/2} \\cdot SE_{z}\n$$\n\nwhere\n\n$$\nSE_{z} = \\sqrt{\\frac{\\sigma_1^2}{n_1} + \\frac{\\sigma_2^2}{n_2}}\n$$\n\n\n:::\n\n## Solution\n\n::: {.solution exercise=\"ex_4\"}\nThe full solution is:\n\n``` r\n#using the t.test() function\ndf_data %>%\n  filter(trt != \"self-guided\") %>%\n  t.test(lsas_post ~ trt, data = ., var.equal = TRUE)\n\n# or manually\n\n#get the parts of the formula\nx_bar_tg <- mean(df_data$lsas_post[df_data$trt == \"therapist-guided\"], na.rm = T)\nx_bar_wl <- mean(df_data$lsas_post[df_data$trt == \"waitlist\"], na.rm = T)\ns_2_tg <- var(df_data$lsas_post[df_data$trt == \"therapist-guided\"], na.rm = T)\ns_2_wl <- var(df_data$lsas_post[df_data$trt == \"waitlist\"], na.rm = T)\nn_tg <- sum(!is.na(df_data$lsas_post[df_data$trt == \"therapist-guided\"]))\nn_wl <- sum(!is.na(df_data$lsas_post[df_data$trt == \"waitlist\"]))\n\n# z-value 95% CI\nse_z <- sqrt((s_2_wl / n_wl) + (s_2_tg / n_tg))\nlcl <- (x_bar_wl - x_bar_tg) - 1.96 * se_z\nucl <- (x_bar_wl - x_bar_tg) + 1.96 * se_z\nprint(c(lcl, ucl))\n #<4>\n```\n:::\n:::::\n\n\n\n\n\n::: {.cell setup='true' exercise='ex_5'}\n```{webr}\n#| setup: true\n#| exercise: ex_5\n# Load the CSV data\nlibrary(dplyr)\ndf_data <- read.csv(\"data/steps_clean.csv\")\n```\n:::\n\n\n\n\n::::: panel-tabset\n##  Exercise 5\n\nConduct a dependent t-test for the difference in LSAS-scores between post-treatment and 12-month follow-up and interprets its meaning \n\n\n\n::: {.cell exercise='ex_5'}\n```{webr}\n#| exercise: ex_5\n\n```\n:::\n\n\n\n## Hints\n\n::: {.hint exercise=\"ex_5\"}\nYou can again calculate it using the `t.test()` function\n``` r\nt.test(df_data$_____, df_data$lsas_post, paired = ____)\n```\nOr if you want to do it manually:\n\nFor a paired samples t-test, the statistic is:\n\n$$\nt = \\frac{\\bar{D}}{SE_D}\n$$\n\nwhere:\n\n$\\bar{D}$ = mean of the difference scores\n\n$SE_D$ = the standard error of the difference scores calculated as $s_D/ \\sqrt{n}$ = the standard error of the differences, with $s_D$ = the standard deviation of the differences and $n$ = the number of paired observations\n\n:::\n\n## Solution\n\n::: {.solution exercise=\"ex_5\"}\nThe full solution is:\n\n``` r\n# using the t-test function\nt.test(df_data$lsas_fu12, df_data$lsas_post, paired = TRUE)\n\n# or manually\ndiff_post_12FU <- df_data$lsas_fu12 - df_data$lsas_post\nmean_diff <- mean(diff_post_12FU, na.rm = TRUE)\nsd_diff <- sd(diff_post_12FU, na.rm = TRUE)\nn <- sum(!is.na(diff_post_12FU))\nse_diff <- sd_diff / sqrt(n)\nt_value <- mean_diff / se_diff\ndf <- n - 1\np_value <- 2 * (1 - pt(abs(t_value), df))\np_value\n #<5>\n```\nThe interpretation is that, for the full group, the LSAS score at the 12-month follow-up show a significant difference to the post-treatment LSAS score.\n:::\n:::::\n\n\n\n::: {.cell setup='true' exercise='ex_6'}\n```{webr}\n#| setup: true\n#| exercise: ex_6\n# Load the CSV data\nlibrary(dplyr)\ndf_data <- read.csv(\"data/steps_clean.csv\")\n```\n:::\n\n\n\n::::: panel-tabset\n##  BONUS Exercise 6\n\nAlso calculate the 95% confidence interval for this difference, using the z-value formula and provide an interpretation of its meaning\n\n\n\n::: {.cell exercise='ex_6'}\n```{webr}\n#| exercise: ex_6\n\n```\n:::\n\n\n\n## Hints\n\n::: {.hint exercise=\"ex_6\"}\n\nWe can  get the z-score confidence intervals of this difference, using a familiar formula for large samples\n\n$$\n\\bar{D} \\;\\pm\\; z_{\\alpha/2} \\cdot SE_D\n$$\nwhere\n$SE_D$ = the standard error of the difference scores calculated as $s_D/ \\sqrt{n}$ = the standard error of the differences, with $s_D$ = the standard deviation of the differences and $n$ = the number of paired observations\n:::\n\n## Solution\n\n::: {.solution exercise=\"ex_6\"}\nThe full solution is:\n\n``` r\ndiff_post_12FU <- df_data$lsas_fu12 - df_data$lsas_post\nmean_diff <- mean(diff_post_12FU, na.rm = TRUE)\nsd_diff <- sd(diff_post_12FU, na.rm = TRUE)\nn <- sum(!is.na(diff_post_12FU))\nse_diff <- sd_diff / sqrt(n)\n\n# and putting it together\nlcl <- mean_diff - 1.96 * se_diff\nucl <- mean_diff + 1.96 * se_diff\nprint(c(lcl, ucl))\n #<6>\n```\n:::\n:::::\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}