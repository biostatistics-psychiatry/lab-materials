<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Tidy Data Manipulation – Biostatistics - Research School in Clinical Psychiatry</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../labs/sampling.html" rel="next">
<link href="../labs/descriptive-statistics.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-0626314e0a662c84ed7be5202fa45f0c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../labs/import-clean.html">Labs</a></li><li class="breadcrumb-item"><a href="../labs/tidy-data-manipulation.html">Tidy data manipulation</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Biostatistics - Research School in Clinical Psychiatry</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Course information</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../r-setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R and RStudio setup</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Labs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/import-clean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Import and clean data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/descriptive-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Descriptive statistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/tidy-data-manipulation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Tidy data manipulation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampling from a population</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/p-values-ci.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">P-values and confidence intervals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/probability-rules.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probability rules</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Classification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/testing-two-means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testing two means</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Exercises</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/lab-1-exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 1 Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/lab-2-exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 2 Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/lab-3-exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 3 exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/lab-4-exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 4 exercises</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#load-packages-and-data" id="toc-load-packages-and-data" class="nav-link active" data-scroll-target="#load-packages-and-data">Load packages and data</a></li>
  <li><a href="#basic-data-operations" id="toc-basic-data-operations" class="nav-link" data-scroll-target="#basic-data-operations">Basic data operations</a>
  <ul>
  <li><a href="#selecting-columns-with-select" id="toc-selecting-columns-with-select" class="nav-link" data-scroll-target="#selecting-columns-with-select">Selecting columns with <code>select()</code></a></li>
  <li><a href="#filtering-rows-with-filter" id="toc-filtering-rows-with-filter" class="nav-link" data-scroll-target="#filtering-rows-with-filter">Filtering rows with <code>filter()</code></a></li>
  <li><a href="#arranging-rows-with-arrange" id="toc-arranging-rows-with-arrange" class="nav-link" data-scroll-target="#arranging-rows-with-arrange">Arranging rows with <code>arrange()</code></a></li>
  </ul></li>
  <li><a href="#creating-new-variables-with-mutate" id="toc-creating-new-variables-with-mutate" class="nav-link" data-scroll-target="#creating-new-variables-with-mutate">Creating new variables with <code>mutate()</code></a>
  <ul>
  <li><a href="#basic-calculations" id="toc-basic-calculations" class="nav-link" data-scroll-target="#basic-calculations">Basic calculations</a></li>
  <li><a href="#creating-categorical-variables" id="toc-creating-categorical-variables" class="nav-link" data-scroll-target="#creating-categorical-variables">Creating categorical variables</a></li>
  </ul></li>
  <li><a href="#summarizing-data-with-group_by-and-summarize" id="toc-summarizing-data-with-group_by-and-summarize" class="nav-link" data-scroll-target="#summarizing-data-with-group_by-and-summarize">Summarizing data with <code>group_by()</code> and <code>summarize()</code></a>
  <ul>
  <li><a href="#basic-summarization" id="toc-basic-summarization" class="nav-link" data-scroll-target="#basic-summarization">Basic summarization</a></li>
  <li><a href="#grouped-summarization" id="toc-grouped-summarization" class="nav-link" data-scroll-target="#grouped-summarization">Grouped summarization</a></li>
  </ul></li>
  <li><a href="#reshaping-data-wide-vs.-long-format" id="toc-reshaping-data-wide-vs.-long-format" class="nav-link" data-scroll-target="#reshaping-data-wide-vs.-long-format">Reshaping data: Wide vs.&nbsp;Long format</a>
  <ul>
  <li><a href="#understanding-wide-vs.-long-format" id="toc-understanding-wide-vs.-long-format" class="nav-link" data-scroll-target="#understanding-wide-vs.-long-format">Understanding wide vs.&nbsp;long format</a></li>
  <li><a href="#converting-to-long-format-with-pivot_longer" id="toc-converting-to-long-format-with-pivot_longer" class="nav-link" data-scroll-target="#converting-to-long-format-with-pivot_longer">Converting to long format with <code>pivot_longer()</code></a></li>
  <li><a href="#cleaning-the-time-variable" id="toc-cleaning-the-time-variable" class="nav-link" data-scroll-target="#cleaning-the-time-variable">Cleaning the time variable</a>
  <ul>
  <li><a href="#working-with-factors" id="toc-working-with-factors" class="nav-link" data-scroll-target="#working-with-factors">Working with factors</a></li>
  <li><a href="#using-factors-in-summaries" id="toc-using-factors-in-summaries" class="nav-link" data-scroll-target="#using-factors-in-summaries">Using factors in summaries</a></li>
  <li><a href="#why-factors-matter-for-visualization" id="toc-why-factors-matter-for-visualization" class="nav-link" data-scroll-target="#why-factors-matter-for-visualization">Why factors matter for visualization</a></li>
  </ul></li>
  <li><a href="#summarizing-longitudinal-data" id="toc-summarizing-longitudinal-data" class="nav-link" data-scroll-target="#summarizing-longitudinal-data">Summarizing longitudinal data</a></li>
  <li><a href="#converting-back-to-wide-format-with-pivot_wider" id="toc-converting-back-to-wide-format-with-pivot_wider" class="nav-link" data-scroll-target="#converting-back-to-wide-format-with-pivot_wider">Converting back to wide format with <code>pivot_wider()</code></a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/biostatistics-psychiatry/lab-materials/edit/main/labs/tidy-data-manipulation.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/biostatistics-psychiatry/lab-materials/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../labs/import-clean.html">Labs</a></li><li class="breadcrumb-item"><a href="../labs/tidy-data-manipulation.html">Tidy data manipulation</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Tidy Data Manipulation</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this lab, we will learn how to manipulate and reshape data using the <em>tidyverse</em> suite of packages. Data manipulation is a crucial skill in biostatistics because raw data is rarely in the format we need for analysis or visualization.</p>
<p>For this lab, we will continue working with the STePS dataset that we cleaned in <a href="../labs/import-clean.html">Import and clean data</a> and explored in <a href="../labs/descriptive-statistics.html">Descriptive statistics</a>. By the end of this lab, you will be able to:</p>
<ul>
<li>Filter rows and select columns based on specific criteria</li>
<li>Create new variables using existing data</li>
<li>Group data and calculate summary statistics</li>
<li>Reshape data between wide and long formats</li>
<li>Understand when to use each data manipulation technique</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why data manipulation matters
</div>
</div>
<div class="callout-body-container callout-body">
<p>We often need to:</p>
<ul>
<li>Calculate change scores from baseline to follow-up</li>
<li>Create treatment group comparisons</li>
<li>Reshape data for different types of analyses</li>
<li>Combine data from multiple sources</li>
</ul>
<p>Data wrangling can often be the most time-consuming part of a project, so it’s important to be efficient and avoid errors.</p>
</div>
</div>
<section id="load-packages-and-data" class="level1">
<h1>Load packages and data</h1>
<p>We’ll use the same packages as before.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s load our cleaned data from the <a href="../labs/import-clean.html">Import and clean data</a> lab:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"steps_clean.csv"</span>))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick check of our data</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 181
Columns: 38
$ id             &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, …
$ group          &lt;dbl&gt; 2, 1, 0, 2, 2, 2, 2, 2, 1, 1, 1, 1, 0, 2, 1, 1, 2, 0, 1…
$ lsas_screen    &lt;dbl&gt; 63, 71, 98, 63, 74, 81, 67, 76, 88, 73, 86, 78, 97, 72,…
$ gad_screen     &lt;dbl&gt; 7, 17, 18, 8, 14, 11, 5, 8, 14, 5, 15, 16, 17, 13, 10, …
$ phq9_screen    &lt;dbl&gt; 6, 13, 19, 4, 18, 8, 9, 8, 14, 3, 5, 11, 12, 18, 10, 4,…
$ bbq_screen     &lt;dbl&gt; 60, 66, 4, 50, 22, 23, 47, 52, 31, 46, 67, 24, 57, 40, …
$ scs_screen     &lt;dbl&gt; 25, 16, 22, 35, 29, 30, 20, 34, 21, 26, 35, 21, 32, 33,…
$ dmrsodf_screen &lt;dbl&gt; 49178, 50727, 45074, 5381, 48444, 50899, 46923, 41428, …
$ ders_screen    &lt;dbl&gt; 44, 73, 65, 45, 46, 49, 57, 38, 67, 45, 55, 56, 71, 36,…
$ pid_5_screen   &lt;dbl&gt; 25, 20, 48, 17, 24, 20, 24, 26, 39, 23, 24, 26, 23, 15,…
$ lsas_v1        &lt;dbl&gt; 72, NA, 81, 44, 39, 65, 68, 69, NA, 70, 92, 83, 102, 50…
$ lsas_v2        &lt;dbl&gt; 64, NA, 89, 33, 115, 64, NA, 70, 97, 83, 94, NA, 74, 62…
$ lsas_v3        &lt;dbl&gt; 72, NA, 73, 36, NA, 63, NA, 71, 92, 62, 103, NA, 85, 54…
$ lsas_v4        &lt;dbl&gt; 61, NA, 94, 44, NA, 60, NA, 51, 85, 61, 99, NA, 84, 52,…
$ lsas_v5        &lt;dbl&gt; 61, NA, 93, 21, NA, 55, NA, 55, NA, 65, 82, NA, 79, 51,…
$ lsas_v6        &lt;dbl&gt; 46, NA, 88, 20, NA, 46, NA, 56, 93, NA, 79, NA, 77, 44,…
$ lsas_v7        &lt;dbl&gt; 55, NA, NA, 18, NA, 45, NA, 64, NA, 54, 101, NA, 89, 43…
$ lsas_v8        &lt;dbl&gt; 49, NA, NA, 17, NA, 44, NA, 52, NA, 61, 84, NA, 89, NA,…
$ lsas_post      &lt;dbl&gt; 50, NA, 77, 22, NA, 52, 75, 45, 79, 64, 80, 89, 83, 45,…
$ gad_post       &lt;dbl&gt; 4, NA, 19, 6, NA, 9, 4, 3, 10, 7, 15, 7, 11, 11, 11, 1,…
$ phq9_post      &lt;dbl&gt; 3, NA, 22, 4, NA, 6, 11, 2, 14, 4, 8, 7, 8, 8, 13, 4, 1…
$ bbq_post       &lt;dbl&gt; 76, NA, 68, 57, NA, 14, 46, 70, 36, 40, 73, 31, 75, 41,…
$ scs_post       &lt;dbl&gt; 34, NA, 34, 34, NA, 30, 19, 34, 23, 23, 31, 37, 34, 34,…
$ dmrsodf_post   &lt;dbl&gt; 50776, NA, 42809, 52069, NA, 51758, 49, 50235, 47978, 4…
$ ders_post      &lt;dbl&gt; 36, NA, 78, 38, NA, 54, 61, 26, 56, 51, 52, 25, 37, 33,…
$ lsas_fu6       &lt;dbl&gt; 33, NA, NA, 14, 6, 60, 64, 49, NA, 45, 85, 74, NA, 58, …
$ gad_fu6        &lt;dbl&gt; 0, NA, NA, 0, NA, 14, 6, 4, NA, 5, 16, NA, NA, 11, 8, 8…
$ phq9_fu6       &lt;dbl&gt; 3, NA, NA, 2, NA, 6, 8, 3, NA, 6, 22, NA, NA, 6, 5, 12,…
$ bbq_fu6        &lt;dbl&gt; 77, NA, NA, 68, NA, 9, 56, 64, NA, 48, 36, NA, NA, 39, …
$ scs_fu6        &lt;dbl&gt; 28, NA, NA, 41, NA, 24, 29, 33, NA, 25, 30, NA, NA, 30,…
$ ders_fu6       &lt;dbl&gt; 35, NA, NA, 36, NA, 72, 61, 26, NA, 37, 67, NA, NA, 36,…
$ lsas_fu12      &lt;dbl&gt; 27, NA, NA, 16, 39, 75, 66, 43, NA, 51, 79, NA, NA, 55,…
$ gad_fu12       &lt;dbl&gt; 5, NA, NA, 0, 11, 7, 6, 4, NA, 4, 14, NA, NA, 8, 19, 12…
$ phq9_fu12      &lt;dbl&gt; 5, NA, NA, 2, 19, 9, 14, 3, NA, 5, 15, NA, NA, 8, 18, 3…
$ bbq_fu12       &lt;dbl&gt; 76, NA, NA, 62, 12, 22, 52, 54, NA, 47, 25, NA, NA, 33,…
$ scs_fu12       &lt;dbl&gt; 38, NA, NA, 40, 28, 33, 26, 34, NA, 21, 30, NA, NA, 32,…
$ ders_fu12      &lt;dbl&gt; 35, NA, NA, 32, 46, 65, 42, 27, NA, 53, 52, NA, NA, 36,…
$ trt            &lt;chr&gt; "therapist-guided", "self-guided", "waitlist", "therapi…</code></pre>
</div>
</div>
</section>
<section id="basic-data-operations" class="level1">
<h1>Basic data operations</h1>
<p>Before we dive into complex data cleaning, let’s start with the fundamental operations of data manipulation.</p>
<section id="selecting-columns-with-select" class="level2">
<h2 class="anchored" data-anchor-id="selecting-columns-with-select">Selecting columns with <code>select()</code></h2>
<p>The <code>select()</code> function allows us to choose which columns (variables) we want to keep in our dataset. This is useful when working with large datasets where you only need a few variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select just ID, group, and baseline LSAS</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df_basic <span class="ot">&lt;-</span> df_data <span class="sc">|&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, group, lsas_screen)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_basic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
     id group lsas_screen
  &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;
1     1     2          63
2     2     1          71
3     3     0          98
4     4     2          63
5     5     2          74
6     6     2          81</code></pre>
</div>
</div>
<p>We can also use helper functions to select multiple columns at once:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select all columns that start with "lsas"</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>df_lsas_all <span class="ot">&lt;-</span> df_data <span class="sc">|&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, group, <span class="fu">starts_with</span>(<span class="st">"lsas"</span>))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Check how many columns we have</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(df_lsas_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df_lsas_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "id"          "group"       "lsas_screen" "lsas_v1"     "lsas_v2"    
 [6] "lsas_v3"     "lsas_v4"     "lsas_v5"     "lsas_v6"     "lsas_v7"    
[11] "lsas_v8"     "lsas_post"   "lsas_fu6"    "lsas_fu12"  </code></pre>
</div>
</div>
<div id="exr-select-columns" class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise&nbsp;1: Practice selecting columns
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Select only the ID, group, and all PHQ-9 variables (columns starting with “phq9”) from the dataset. How many columns does your new dataset have?</p>
</div>
</div>
</div>
</section>
<section id="filtering-rows-with-filter" class="level2">
<h2 class="anchored" data-anchor-id="filtering-rows-with-filter">Filtering rows with <code>filter()</code></h2>
<p>The <code>filter()</code> function allows us to select specific rows based on conditions. This is useful for creating subgroups or excluding certain participants.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only participants in the guided treatment group (group == 2)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df_guided <span class="ot">&lt;-</span> df_data <span class="sc">|&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df_guided)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 60</code></pre>
</div>
</div>
<p>We can use multiple conditions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep participants in guided treatment with baseline LSAS &gt;= 60</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>df_guided_severe <span class="ot">&lt;-</span> df_data <span class="sc">|&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="dv">2</span>, lsas_screen <span class="sc">&gt;=</span> <span class="dv">60</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df_guided_severe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 60</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Common filter conditions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>==</code> : equal to</li>
<li><code>!=</code> : not equal to<br>
</li>
<li><code>&gt;</code>, <code>&gt;=</code> : greater than (or equal)</li>
<li><code>&lt;</code>, <code>&lt;=</code> : less than (or equal)</li>
<li><code>%in%</code> : is in a list of values</li>
<li><code>is.na()</code> : is missing</li>
<li><code>!is.na()</code> : is not missing</li>
</ul>
</div>
</div>
<div id="exr-filter-data" class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise&nbsp;2: Practice filtering data
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Filter the data to include only participants with baseline LSAS scores between 50 and 80.</li>
<li>Filter to include only participants in groups 1 or 2 (exclude waitlist).</li>
<li>How many participants meet both criteria?</li>
</ol>
</div>
</div>
</div>
</section>
<section id="arranging-rows-with-arrange" class="level2">
<h2 class="anchored" data-anchor-id="arranging-rows-with-arrange">Arranging rows with <code>arrange()</code></h2>
<p>The <code>arrange()</code> function sorts your data by one or more variables. This can be helpful for identifying extreme values or organizing data for presentation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by baseline LSAS score (lowest to highest)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>df_sorted <span class="ot">&lt;-</span> df_data <span class="sc">|&gt;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, group, lsas_screen) <span class="sc">|&gt;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(lsas_screen)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_sorted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
     id group lsas_screen
  &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;
1    65     2          60
2   124     1          60
3   140     0          60
4   146     0          60
5   157     0          60
6    58     0          61</code></pre>
</div>
</div>
<p>Use <code>desc()</code> for descending order:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by baseline LSAS score (highest to lowest)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>df_sorted_desc <span class="ot">&lt;-</span> df_data <span class="sc">|&gt;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, group, lsas_screen) <span class="sc">|&gt;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(lsas_screen))</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_sorted_desc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
     id group lsas_screen
  &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;
1   123     0         134
2    23     0         131
3    35     0         131
4    53     0         128
5   170     2         128
6    55     2         125</code></pre>
</div>
</div>
</section>
</section>
<section id="creating-new-variables-with-mutate" class="level1">
<h1>Creating new variables with <code>mutate()</code></h1>
<p>The <code>mutate()</code> function allows us to create new variables or modify existing ones. This is often used for creating derived variables, such as change scores or standardized scores.</p>
<section id="basic-calculations" class="level2">
<h2 class="anchored" data-anchor-id="basic-calculations">Basic calculations</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df_with_change <span class="ot">&lt;-</span> df_data <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, group, lsas_screen, lsas_post) <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate change score (post - baseline)</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">lsas_change =</span> lsas_post <span class="sc">-</span> lsas_screen,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate percentage change</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">lsas_pct_change =</span> (lsas_change <span class="sc">/</span> lsas_screen) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_with_change)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
     id group lsas_screen lsas_post lsas_change lsas_pct_change
  &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;           &lt;dbl&gt;
1     1     2          63        50         -13           -20.6
2     2     1          71        NA          NA            NA  
3     3     0          98        77         -21           -21.4
4     4     2          63        22         -41           -65.1
5     5     2          74        NA          NA            NA  
6     6     2          81        52         -29           -35.8</code></pre>
</div>
</div>
</section>
<section id="creating-categorical-variables" class="level2">
<h2 class="anchored" data-anchor-id="creating-categorical-variables">Creating categorical variables</h2>
<p>We often need to create categorical versions of continuous variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df_with_categories <span class="ot">&lt;-</span> df_data <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, group, phq9_screen, gad_screen) <span class="sc">|&gt;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Using case_when() for PHQ9 severity categories</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">phq9_severity =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>      phq9_screen <span class="sc">&lt;</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Minimal"</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>      phq9_screen <span class="sc">&lt;</span> <span class="dv">10</span> <span class="sc">~</span> <span class="st">"Mild"</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>      phq9_screen <span class="sc">&lt;</span> <span class="dv">15</span> <span class="sc">~</span> <span class="st">"Moderate"</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>      phq9_screen <span class="sc">&lt;</span> <span class="dv">20</span> <span class="sc">~</span> <span class="st">"Moderately severe"</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>      phq9_screen <span class="sc">&gt;=</span> <span class="dv">20</span> <span class="sc">~</span> <span class="st">"Severe"</span>,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(phq9_screen) <span class="sc">~</span> <span class="st">"Missing"</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to factor</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">phq9_severity =</span> <span class="fu">factor</span>(</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>      phq9_severity,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Minimal"</span>,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Mild"</span>,</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Moderate"</span>,</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Moderately severe"</span>,</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Severe"</span>,</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Missing"</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">ordered =</span> <span class="cn">TRUE</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create binary variable for high anxiety</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">high_anxiety =</span> <span class="fu">factor</span>(</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ifelse</span>(gad_screen <span class="sc">&gt;=</span> <span class="dv">10</span>, <span class="st">"High"</span>, <span class="st">"Low"</span>),</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"High"</span>)</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create more readable group labels</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">group_label =</span> <span class="fu">factor</span>(group,</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Waitlist"</span>, <span class="st">"Self-guided"</span>, <span class="st">"Therapist-guided"</span>)</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Check our new variables</span></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df_with_categories<span class="sc">$</span>phq9_severity)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
          Minimal              Mild          Moderate Moderately severe 
               19                80                52                30 
           Severe           Missing 
                0                 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df_with_categories<span class="sc">$</span>group_label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
        Waitlist      Self-guided Therapist-guided 
              60               61               60 </code></pre>
</div>
</div>
<p>We can check how our created PHQ9 categories map to the raw scores:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df_with_categories <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(phq9_screen, phq9_severity) <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(phq9_screen, phq9_severity) <span class="sc">|&gt;</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(phq9_screen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 19 × 2
   phq9_screen phq9_severity    
         &lt;dbl&gt; &lt;ord&gt;            
 1           1 Minimal          
 2           2 Minimal          
 3           3 Minimal          
 4           4 Minimal          
 5           5 Mild             
 6           6 Mild             
 7           7 Mild             
 8           8 Mild             
 9           9 Mild             
10          10 Moderate         
11          11 Moderate         
12          12 Moderate         
13          13 Moderate         
14          14 Moderate         
15          15 Moderately severe
16          16 Moderately severe
17          17 Moderately severe
18          18 Moderately severe
19          19 Moderately severe</code></pre>
</div>
</div>
<div id="exr-create-variables" class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise&nbsp;3: Create new variables
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Create a new variable called <code>gad_severity</code> that categorizes GAD-7 scores as:
<ul>
<li>“Minimal” (0-4)</li>
<li>“Mild” (5-9)</li>
<li>“Moderate” (10-14)</li>
<li>“Severe” (15+)</li>
</ul></li>
<li>Create a binary variable indicating whether someone has both high anxiety (GAD-7 ≥ 10) AND moderate-to-severe depression (PHQ-9 ≥ 10).</li>
</ol>
</div>
</div>
</div>
</section>
</section>
<section id="summarizing-data-with-group_by-and-summarize" class="level1">
<h1>Summarizing data with <code>group_by()</code> and <code>summarize()</code></h1>
<p>A very common task is grouping data and calculating summary statistics.</p>
<section id="basic-summarization" class="level2">
<h2 class="anchored" data-anchor-id="basic-summarization">Basic summarization</h2>
<p>We can use the <code>summarize()</code> (from <code>dplyr</code>) function to calculate summary statistics for our data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate overall statistics</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>df_data <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_participants =</span> <span class="fu">n</span>(),</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_lsas =</span> <span class="fu">mean</span>(lsas_screen, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_lsas =</span> <span class="fu">sd</span>(lsas_screen, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_lsas =</span> <span class="fu">median</span>(lsas_screen, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  n_participants mean_lsas sd_lsas median_lsas
           &lt;int&gt;     &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt;
1            181      84.8    16.5          82</code></pre>
</div>
</div>
</section>
<section id="grouped-summarization" class="level2">
<h2 class="anchored" data-anchor-id="grouped-summarization">Grouped summarization</h2>
<p>More often, we want to calculate statistics by groups:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate statistics by treatment group</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>group_stats <span class="ot">&lt;-</span> df_data <span class="sc">|&gt;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(group) <span class="sc">|&gt;</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_participants =</span> <span class="fu">n</span>(),</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_lsas =</span> <span class="fu">mean</span>(lsas_screen, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_lsas =</span> <span class="fu">sd</span>(lsas_screen, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_lsas =</span> <span class="fu">median</span>(lsas_screen, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span> <span class="co"># This removes the grouping</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>group_stats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  group n_participants mean_lsas sd_lsas median_lsas
  &lt;dbl&gt;          &lt;int&gt;     &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt;
1     0             60      87.0    19.0          83
2     1             61      83.1    13.0          82
3     2             60      84.2    17.0          81</code></pre>
</div>
</div>
<p>We can also use the <code>.by</code> syntax which is often cleaner:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df_data <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_participants =</span> <span class="fu">n</span>(),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_lsas =</span> <span class="fu">mean</span>(lsas_screen, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_lsas =</span> <span class="fu">sd</span>(lsas_screen, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> group</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  group n_participants mean_lsas sd_lsas
  &lt;dbl&gt;          &lt;int&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1     2             60      84.2    17.0
2     1             61      83.1    13.0
3     0             60      87.0    19.0</code></pre>
</div>
</div>
<div id="exr-summarize-data" class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise&nbsp;4: Practice summarizing data
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Calculate the mean and standard deviation of GAD-7 scores by treatment group.</li>
<li>Calculate the number of participants and percentage with high anxiety (GAD-7 ≥ 10) by treatment group.</li>
</ol>
</div>
</div>
</div>
</section>
</section>
<section id="reshaping-data-wide-vs.-long-format" class="level1">
<h1>Reshaping data: Wide vs.&nbsp;Long format</h1>
<p>Understanding data shapes is crucial for analysis and visualization. Let’s explore the difference between wide and long format data.</p>
<section id="understanding-wide-vs.-long-format" class="level2">
<h2 class="anchored" data-anchor-id="understanding-wide-vs.-long-format">Understanding wide vs.&nbsp;long format</h2>
<p>Our data is currently in wide format, where each participant has one row, with repeated measures in separate columns.</p>
<ul>
<li><strong>Wide format</strong>: Each participant has one row, with repeated measures in separate columns<br>
</li>
<li><strong>Long format</strong>: Each measurement has its own row, with a column indicating the time point</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
When to use each format
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Wide format</strong>: Calculating change scores, some statistical tests (e.g., SEM), demographic tables</li>
<li><strong>Long format</strong>: Plotting over time, mixed-effects models, most <code>ggplot</code> visualizations</li>
</ul>
</div>
</div>
</section>
<section id="converting-to-long-format-with-pivot_longer" class="level2">
<h2 class="anchored" data-anchor-id="converting-to-long-format-with-pivot_longer">Converting to long format with <code>pivot_longer()</code></h2>
<p>Let’s focus on the LSAS measurements across time. First, let’s see what LSAS columns we have:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check what LSAS columns we have</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>df_data <span class="sc">|&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"lsas"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "lsas_screen" "lsas_v1"     "lsas_v2"     "lsas_v3"     "lsas_v4"    
 [6] "lsas_v5"     "lsas_v6"     "lsas_v7"     "lsas_v8"     "lsas_post"  
[11] "lsas_fu6"    "lsas_fu12"  </code></pre>
</div>
</div>
<p>All of the columns that start with “lsas” are LSAS scores at different time points. Now let’s convert to long format:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>df_lsas_long <span class="ot">&lt;-</span> df_data <span class="sc">|&gt;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, group, <span class="fu">starts_with</span>(<span class="st">"lsas"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"lsas"</span>), <span class="co"># Which columns to pivot</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"time_point"</span>, <span class="co"># Name for the new column with time info</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"lsas_score"</span> <span class="co"># Name for the new column with values</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_lsas_long, <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
      id group time_point  lsas_score
   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt;
 1     1     2 lsas_screen         63
 2     1     2 lsas_v1             72
 3     1     2 lsas_v2             64
 4     1     2 lsas_v3             72
 5     1     2 lsas_v4             61
 6     1     2 lsas_v5             61
 7     1     2 lsas_v6             46
 8     1     2 lsas_v7             55
 9     1     2 lsas_v8             49
10     1     2 lsas_post           50
11     1     2 lsas_fu6            33
12     1     2 lsas_fu12           27</code></pre>
</div>
</div>
</section>
<section id="cleaning-the-time-variable" class="level2">
<h2 class="anchored" data-anchor-id="cleaning-the-time-variable">Cleaning the time variable</h2>
<p>The time variable is not very readable. Let’s clean it up and create properly ordered factors:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df_lsas_long <span class="ot">&lt;-</span> df_lsas_long <span class="sc">|&gt;</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Split the time_point column to separate "lsas" from the actual time</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(time_point, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"measure"</span>, <span class="st">"time"</span>), <span class="at">sep =</span> <span class="st">"_"</span>) <span class="sc">|&gt;</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a cleaner time variable</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_clean =</span> <span class="fu">case_when</span>(</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>      time <span class="sc">==</span> <span class="st">"screen"</span> <span class="sc">~</span> <span class="st">"Baseline"</span>,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>      time <span class="sc">==</span> <span class="st">"v1"</span> <span class="sc">~</span> <span class="st">"Week 1"</span>,</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>      time <span class="sc">==</span> <span class="st">"v2"</span> <span class="sc">~</span> <span class="st">"Week 2"</span>,</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>      time <span class="sc">==</span> <span class="st">"v3"</span> <span class="sc">~</span> <span class="st">"Week 3"</span>,</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>      time <span class="sc">==</span> <span class="st">"v4"</span> <span class="sc">~</span> <span class="st">"Week 4"</span>,</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>      time <span class="sc">==</span> <span class="st">"v5"</span> <span class="sc">~</span> <span class="st">"Week 5"</span>,</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>      time <span class="sc">==</span> <span class="st">"v6"</span> <span class="sc">~</span> <span class="st">"Week 6"</span>,</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>      time <span class="sc">==</span> <span class="st">"v7"</span> <span class="sc">~</span> <span class="st">"Week 7"</span>,</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>      time <span class="sc">==</span> <span class="st">"v8"</span> <span class="sc">~</span> <span class="st">"Week 8"</span>,</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>      time <span class="sc">==</span> <span class="st">"post"</span> <span class="sc">~</span> <span class="st">"Post-treatment"</span>,</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>      time <span class="sc">==</span> <span class="st">"fu6"</span> <span class="sc">~</span> <span class="st">"6-month follow-up"</span>,</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>      time <span class="sc">==</span> <span class="st">"fu12"</span> <span class="sc">~</span> <span class="st">"12-month follow-up"</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Also create a numeric week variable for plotting</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">week_num =</span> <span class="fu">case_when</span>(</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>      time <span class="sc">==</span> <span class="st">"screen"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>      time <span class="sc">==</span> <span class="st">"v1"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>      time <span class="sc">==</span> <span class="st">"v2"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>      time <span class="sc">==</span> <span class="st">"v3"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>      time <span class="sc">==</span> <span class="st">"v4"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>      time <span class="sc">==</span> <span class="st">"v5"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>      time <span class="sc">==</span> <span class="st">"v6"</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>      time <span class="sc">==</span> <span class="st">"v7"</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>      time <span class="sc">==</span> <span class="st">"v8"</span> <span class="sc">~</span> <span class="dv">8</span>,</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>      time <span class="sc">==</span> <span class="st">"post"</span> <span class="sc">~</span> <span class="dv">9</span>,</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>      time <span class="sc">==</span> <span class="st">"fu6"</span> <span class="sc">~</span> <span class="dv">33</span>, <span class="co"># 9 + 6*4 weeks</span></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>      time <span class="sc">==</span> <span class="st">"fu12"</span> <span class="sc">~</span> <span class="dv">57</span> <span class="co"># 9 + 12*4 weeks</span></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove the "measure" column since it's just "lsas" for all rows</span></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>measure)</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_lsas_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
     id group time   lsas_score time_clean week_num
  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;
1     1     2 screen         63 Baseline          0
2     1     2 v1             72 Week 1            1
3     1     2 v2             64 Week 2            2
4     1     2 v3             72 Week 3            3
5     1     2 v4             61 Week 4            4
6     1     2 v5             61 Week 5            5</code></pre>
</div>
</div>
<section id="working-with-factors" class="level3">
<h3 class="anchored" data-anchor-id="working-with-factors">Working with factors</h3>
<p>You might notice that when we try to sort or plot this data, the time points don’t appear in chronological order. This is because R treats them as character strings and sorts them alphabetically. We need to convert them to <strong>factors</strong> with a specific order.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What are factors?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Factors are R’s way of handling categorical data with a specific order or set of allowed values. They’re especially important in data analysis to:</p>
<ul>
<li>Ensuring consistent category names (no typos)</li>
<li>Controlling the order of categories in tables and plots</li>
<li>Proper statistical analysis of categorical variables</li>
</ul>
</div>
</div>
<p>Let’s see the problem first:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the current order</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df_lsas_long<span class="sc">$</span>time_clean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Baseline"           "Week 1"             "Week 2"            
 [4] "Week 3"             "Week 4"             "Week 5"            
 [7] "Week 6"             "Week 7"             "Week 8"            
[10] "Post-treatment"     "6-month follow-up"  "12-month follow-up"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># See what happens when we sort</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">unique</span>(df_lsas_long<span class="sc">$</span>time_clean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "12-month follow-up" "6-month follow-up"  "Baseline"          
 [4] "Post-treatment"     "Week 1"             "Week 2"            
 [7] "Week 3"             "Week 4"             "Week 5"            
[10] "Week 6"             "Week 7"             "Week 8"            </code></pre>
</div>
</div>
<p>Now let’s fix this by creating a properly ordered factor:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats) <span class="co"># Part of tidyverse, for working with factors</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>df_lsas_long <span class="ot">&lt;-</span> df_lsas_long <span class="sc">|&gt;</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a factor for time points with proper ordering</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_factor =</span> <span class="fu">factor</span>(</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>      time_clean,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Baseline"</span>, <span class="st">"Week 1"</span>, <span class="st">"Week 2"</span>, <span class="st">"Week 3"</span>, <span class="st">"Week 4"</span>,</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Week 5"</span>, <span class="st">"Week 6"</span>, <span class="st">"Week 7"</span>, <span class="st">"Week 8"</span>,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Post-treatment"</span>, <span class="st">"6-month follow-up"</span>, <span class="st">"12-month follow-up"</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a factor for treatment groups with meaningful labels</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">group_factor =</span> <span class="fu">factor</span>(</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>      group,</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Waitlist"</span>, <span class="st">"Self-guided"</span>, <span class="st">"Therapist-guided"</span>)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Check our factors</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df_lsas_long<span class="sc">$</span>time_factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Baseline"           "Week 1"             "Week 2"            
 [4] "Week 3"             "Week 4"             "Week 5"            
 [7] "Week 6"             "Week 7"             "Week 8"            
[10] "Post-treatment"     "6-month follow-up"  "12-month follow-up"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df_lsas_long<span class="sc">$</span>group_factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Waitlist"         "Self-guided"      "Therapist-guided"</code></pre>
</div>
</div>
<p>Let’s see how factors help by comparing how character vs factor variables are ordered:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, let's see the unique values in each format</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df_lsas_long<span class="sc">$</span>time_clean) <span class="sc">|&gt;</span> <span class="fu">sort</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "12-month follow-up" "6-month follow-up"  "Baseline"          
 [4] "Post-treatment"     "Week 1"             "Week 2"            
 [7] "Week 3"             "Week 4"             "Week 5"            
[10] "Week 6"             "Week 7"             "Week 8"            </code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(df_lsas_long<span class="sc">$</span>time_factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Baseline"           "Week 1"             "Week 2"            
 [4] "Week 3"             "Week 4"             "Week 5"            
 [7] "Week 6"             "Week 7"             "Week 8"            
[10] "Post-treatment"     "6-month follow-up"  "12-month follow-up"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare what happens when we arrange/sort the data</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>df_lsas_long <span class="sc">|&gt;</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(time_clean, time_factor) <span class="sc">|&gt;</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(time_clean) <span class="sc">|&gt;</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(time_clean, time_factor) <span class="sc">|&gt;</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 2
  time_clean         time_factor       
  &lt;chr&gt;              &lt;fct&gt;             
1 12-month follow-up 12-month follow-up
2 6-month follow-up  6-month follow-up 
3 Baseline           Baseline          
4 Post-treatment     Post-treatment    
5 Week 1             Week 1            
6 Week 2             Week 2            
7 Week 3             Week 3            
8 Week 4             Week 4            </code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>df_lsas_long <span class="sc">|&gt;</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(time_clean, time_factor) <span class="sc">|&gt;</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(time_factor) <span class="sc">|&gt;</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(time_clean, time_factor) <span class="sc">|&gt;</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 2
  time_clean time_factor
  &lt;chr&gt;      &lt;fct&gt;      
1 Baseline   Baseline   
2 Week 1     Week 1     
3 Week 2     Week 2     
4 Week 3     Week 3     
5 Week 4     Week 4     
6 Week 5     Week 5     
7 Week 6     Week 6     
8 Week 7     Week 7     </code></pre>
</div>
</div>
<p><strong>Notice the difference</strong>:</p>
<ul>
<li>The character variable sorts alphabetically: “12-month follow-up” comes before “6-month follow-up”</li>
<li>The factor variable sorts logically: Baseline → Week 1 → Week 2 → … → Post-treatment → Follow-ups</li>
</ul>
<p>This is why factors are essential for any categorical variable where order matters!</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Useful factor functions from forcats
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>fct_relevel()</code>: Change the order of factor levels</li>
<li><code>fct_reorder()</code>: Reorder factor levels by another variable</li>
<li><code>fct_recode()</code>: Change factor level names</li>
<li><code>fct_collapse()</code>: Combine factor levels</li>
<li><code>fct_lump()</code>: Collapse least common levels into “Other”</li>
</ul>
</div>
</div>
</section>
<section id="using-factors-in-summaries" class="level3">
<h3 class="anchored" data-anchor-id="using-factors-in-summaries">Using factors in summaries</h3>
<p>Now our factors will behave properly in summaries and plots:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary by time point (now in correct order!)</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>time_summary <span class="ot">&lt;-</span> df_lsas_long <span class="sc">|&gt;</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_obs =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(lsas_score)),</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_lsas =</span> <span class="fu">mean</span>(lsas_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> time_factor</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>time_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 3
   time_factor        n_obs mean_lsas
   &lt;fct&gt;              &lt;int&gt;     &lt;dbl&gt;
 1 Baseline             181      84.8
 2 Week 1               172      80.1
 3 Week 2               158      79.3
 4 Week 3               142      77.8
 5 Week 4               142      75.6
 6 Week 5               124      73.6
 7 Week 6               132      70.2
 8 Week 7               123      69.5
 9 Week 8               119      67.8
10 Post-treatment       169      67.1
11 6-month follow-up    104      57.0
12 12-month follow-up   101      55  </code></pre>
</div>
</div>
<div id="exr-practice-factors" class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise&nbsp;5: Practice with factors
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Create a factor for LSAS severity levels with the order: “Mild”, “Moderate”, “Severe”</li>
<li>Create a factor for depression categories using PHQ-9 scores with proper ordering</li>
<li>Use <code>fct_recode()</code> to change “Self-guided” to “Self-guided CBT” in the group factor</li>
<li>Check that your factors appear in the correct order when you create a summary table</li>
</ol>
</div>
</div>
</div>
</section>
<section id="why-factors-matter-for-visualization" class="level3">
<h3 class="anchored" data-anchor-id="why-factors-matter-for-visualization">Why factors matter for visualization</h3>
<p>Factors ensure that our plots display categories in the correct order:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare plots with and without proper factor ordering</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data for demonstration</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> df_lsas_long <span class="sc">|&gt;</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_lsas =</span> <span class="fu">mean</span>(lsas_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">c</span>(time_clean, time_factor, week_num, group_factor)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with character variable (wrong order)</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> time_clean, <span class="at">y =</span> mean_lsas, <span class="at">color =</span> group_factor)) <span class="sc">+</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> group_factor)) <span class="sc">+</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Character variable (alphabetical order)"</span>, <span class="at">x =</span> <span class="st">"Time"</span>) <span class="sc">+</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with factor variable (correct order)</span></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> time_factor, <span class="at">y =</span> mean_lsas, <span class="at">color =</span> group_factor)) <span class="sc">+</span></span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> group_factor)) <span class="sc">+</span></span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Factor variable (logical order)"</span>, <span class="at">x =</span> <span class="st">"Time"</span>) <span class="sc">+</span></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Display both plots</span></span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tidy-data-manipulation_files/figure-html/factors-plotting-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tidy-data-manipulation_files/figure-html/factors-plotting-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  plot_data,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> week_num,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> mean_lsas,</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> group_factor</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> group_factor)) <span class="sc">+</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> plot_data<span class="sc">$</span>week_num, <span class="co"># Use numeric positions</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> plot_data<span class="sc">$</span>time_clean <span class="co"># Use readable labels</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Factor variable + Numeric Positions"</span>, <span class="at">x =</span> <span class="st">"Time"</span>) <span class="sc">+</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tidy-data-manipulation_files/figure-html/factors-plotting-numeric-time-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key points about factors
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><strong>Always use factors for categorical variables</strong> that will be used in analysis or plotting</li>
<li><strong>Set the levels in logical order</strong> (not alphabetical)</li>
<li><strong>Use meaningful labels</strong> instead of numeric codes</li>
<li><strong>Factors control the order</strong> in tables, plots, and statistical output</li>
<li><strong>The <code>forcats</code> package</strong> provides helpful functions for factor manipulation</li>
</ol>
</div>
</div>
</section>
</section>
<section id="summarizing-longitudinal-data" class="level2">
<h2 class="anchored" data-anchor-id="summarizing-longitudinal-data">Summarizing longitudinal data</h2>
<p>Now that we have our data in long format, we can easily calculate means by group and time:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>lsas_summary <span class="ot">&lt;-</span> df_lsas_long <span class="sc">|&gt;</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_obs =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(lsas_score)),</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_lsas =</span> <span class="fu">mean</span>(lsas_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_lsas =</span> <span class="fu">sd</span>(lsas_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">c</span>(group_factor, time_factor)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>lsas_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 36 × 5
   group_factor     time_factor    n_obs mean_lsas sd_lsas
   &lt;fct&gt;            &lt;fct&gt;          &lt;int&gt;     &lt;dbl&gt;   &lt;dbl&gt;
 1 Therapist-guided Baseline          60      84.2    17.0
 2 Therapist-guided Week 1            59      78.3    19.2
 3 Therapist-guided Week 2            51      77.5    20.8
 4 Therapist-guided Week 3            48      75.7    21.1
 5 Therapist-guided Week 4            49      72.0    19.1
 6 Therapist-guided Week 5            45      68.9    23.6
 7 Therapist-guided Week 6            47      61.9    20.9
 8 Therapist-guided Week 7            48      61.8    23.9
 9 Therapist-guided Week 8            43      57.5    21.8
10 Therapist-guided Post-treatment    54      57.4    23.2
# ℹ 26 more rows</code></pre>
</div>
</div>
</section>
<section id="converting-back-to-wide-format-with-pivot_wider" class="level2">
<h2 class="anchored" data-anchor-id="converting-back-to-wide-format-with-pivot_wider">Converting back to wide format with <code>pivot_wider()</code></h2>
<p>Sometimes we need to convert back to wide format, for example to create a table with means by group and time:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a wide format table with groups as columns (just means)</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>lsas_wide_simple <span class="ot">&lt;-</span> lsas_summary <span class="sc">|&gt;</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(time_factor, group_factor, mean_lsas) <span class="sc">|&gt;</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> group_factor,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> mean_lsas,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"mean_"</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>lsas_wide_simple</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   time_factor        `mean_Therapist-guided` `mean_Self-guided` mean_Waitlist
   &lt;fct&gt;                                &lt;dbl&gt;              &lt;dbl&gt;         &lt;dbl&gt;
 1 Baseline                              84.2               83.1          87.0
 2 Week 1                                78.3               78.5          83.5
 3 Week 2                                77.5               78.4          81.9
 4 Week 3                                75.7               77.3          80.3
 5 Week 4                                72.0               71.2          82.3
 6 Week 5                                68.9               69.6          81.0
 7 Week 6                                61.9               67.8          80.0
 8 Week 7                                61.8               69.5          78.0
 9 Week 8                                57.5               67.1          77.9
10 Post-treatment                        57.4               64.9          78.4
11 6-month follow-up                     56.4               57.7         NaN  
12 12-month follow-up                    55.7               54.2         NaN  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># More complex example: keeping multiple statistics (mean, sd, and n)</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>lsas_wide_detailed <span class="ot">&lt;-</span> lsas_summary <span class="sc">|&gt;</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> group_factor,</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="fu">c</span>(mean_lsas, sd_lsas, n_obs),</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_sep =</span> <span class="st">"_"</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>lsas_wide_detailed <span class="sc">|&gt;</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">time_factor</th>
<th style="text-align: right;">mean_lsas_Therapist-guided</th>
<th style="text-align: right;">mean_lsas_Self-guided</th>
<th style="text-align: right;">mean_lsas_Waitlist</th>
<th style="text-align: right;">sd_lsas_Therapist-guided</th>
<th style="text-align: right;">sd_lsas_Self-guided</th>
<th style="text-align: right;">sd_lsas_Waitlist</th>
<th style="text-align: right;">n_obs_Therapist-guided</th>
<th style="text-align: right;">n_obs_Self-guided</th>
<th style="text-align: right;">n_obs_Waitlist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Baseline</td>
<td style="text-align: right;">84.22</td>
<td style="text-align: right;">83.08</td>
<td style="text-align: right;">86.98</td>
<td style="text-align: right;">16.95</td>
<td style="text-align: right;">12.97</td>
<td style="text-align: right;">18.99</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">60</td>
</tr>
<tr class="even">
<td style="text-align: left;">Week 1</td>
<td style="text-align: right;">78.27</td>
<td style="text-align: right;">78.45</td>
<td style="text-align: right;">83.47</td>
<td style="text-align: right;">19.17</td>
<td style="text-align: right;">14.41</td>
<td style="text-align: right;">19.63</td>
<td style="text-align: right;">59</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">58</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Week 2</td>
<td style="text-align: right;">77.53</td>
<td style="text-align: right;">78.37</td>
<td style="text-align: right;">81.95</td>
<td style="text-align: right;">20.79</td>
<td style="text-align: right;">16.92</td>
<td style="text-align: right;">22.48</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">55</td>
</tr>
<tr class="even">
<td style="text-align: left;">Week 3</td>
<td style="text-align: right;">75.67</td>
<td style="text-align: right;">77.28</td>
<td style="text-align: right;">80.27</td>
<td style="text-align: right;">21.10</td>
<td style="text-align: right;">18.22</td>
<td style="text-align: right;">21.29</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">51</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Week 4</td>
<td style="text-align: right;">71.98</td>
<td style="text-align: right;">71.24</td>
<td style="text-align: right;">82.35</td>
<td style="text-align: right;">19.13</td>
<td style="text-align: right;">17.59</td>
<td style="text-align: right;">24.01</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">52</td>
</tr>
<tr class="even">
<td style="text-align: left;">Week 5</td>
<td style="text-align: right;">68.91</td>
<td style="text-align: right;">69.58</td>
<td style="text-align: right;">81.02</td>
<td style="text-align: right;">23.62</td>
<td style="text-align: right;">20.87</td>
<td style="text-align: right;">21.33</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">46</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Week 6</td>
<td style="text-align: right;">61.87</td>
<td style="text-align: right;">67.81</td>
<td style="text-align: right;">80.04</td>
<td style="text-align: right;">20.90</td>
<td style="text-align: right;">19.88</td>
<td style="text-align: right;">25.35</td>
<td style="text-align: right;">47</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">49</td>
</tr>
<tr class="even">
<td style="text-align: left;">Week 7</td>
<td style="text-align: right;">61.75</td>
<td style="text-align: right;">69.52</td>
<td style="text-align: right;">77.98</td>
<td style="text-align: right;">23.94</td>
<td style="text-align: right;">21.46</td>
<td style="text-align: right;">26.96</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">44</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Week 8</td>
<td style="text-align: right;">57.47</td>
<td style="text-align: right;">67.13</td>
<td style="text-align: right;">77.87</td>
<td style="text-align: right;">21.82</td>
<td style="text-align: right;">21.87</td>
<td style="text-align: right;">25.72</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">46</td>
</tr>
<tr class="even">
<td style="text-align: left;">Post-treatment</td>
<td style="text-align: right;">57.35</td>
<td style="text-align: right;">64.91</td>
<td style="text-align: right;">78.45</td>
<td style="text-align: right;">23.19</td>
<td style="text-align: right;">21.08</td>
<td style="text-align: right;">25.44</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">57</td>
<td style="text-align: right;">58</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6-month follow-up</td>
<td style="text-align: right;">56.42</td>
<td style="text-align: right;">57.71</td>
<td style="text-align: right;">NaN</td>
<td style="text-align: right;">25.81</td>
<td style="text-align: right;">21.98</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">12-month follow-up</td>
<td style="text-align: right;">55.71</td>
<td style="text-align: right;">54.24</td>
<td style="text-align: right;">NaN</td>
<td style="text-align: right;">26.18</td>
<td style="text-align: right;">25.15</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Advanced pivot_wider: Multiple value columns
</div>
</div>
<div class="callout-body-container callout-body">
<p>Notice how <code>pivot_wider()</code> can handle multiple value columns at once:</p>
<ul>
<li><code>values_from = c(mean_lsas, sd_lsas, n_obs)</code>: Pivots all three statistics</li>
<li><code>names_sep = "_"</code>: Controls how column names are created</li>
<li>Result: Each group gets three columns (e.g., <code>mean_lsas_Waitlist</code>, <code>sd_lsas_Waitlist</code>, <code>n_obs_Waitlist</code>)</li>
</ul>
<p>This is very useful for creating comprehensive summary tables!</p>
</div>
</div>
<div id="exr-reshape-data" class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise&nbsp;6: Practice reshaping data
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Convert the GAD-7 data to long format (select columns starting with “gad”).</li>
<li>Calculate the mean GAD-7 score by group and time point.</li>
<li>Create a wide format table showing GAD-7 means with time points as rows and groups as columns.</li>
</ol>
</div>
</div>
</div>
<div id="exr-comprehensive-manipulation" class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise&nbsp;7: Comprehensive data manipulation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Combine everything you’ve learned to:</p>
<ol type="1">
<li>Create a dataset with only baseline and post-treatment measurements for LSAS, GAD-7, and PHQ-9.</li>
<li>Calculate change scores for each measure.</li>
<li>Create a summary table showing mean change scores by treatment group.</li>
<li>Create categories for treatment response (e.g., “Improved” if LSAS decreased by ≥10 points).</li>
<li>Calculate the percentage of responders in each treatment group.</li>
</ol>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using gt for better table formatting</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>my_table <span class="ot">&lt;-</span> lsas_wide_detailed <span class="sc">|&gt;</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner</span>(</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Waitlist"</span>,</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">contains</span>(<span class="st">"Waitlist"</span>)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner</span>(</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Self-guided"</span>,</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">contains</span>(<span class="st">"Self-guided"</span>)</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner</span>(</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Therapist-guided"</span>,</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">contains</span>(<span class="st">"Therapist-guided"</span>)</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_factor =</span> <span class="st">"Time Point"</span>,</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_lsas_Waitlist =</span> <span class="st">"M"</span>,</span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_lsas_Waitlist =</span> <span class="st">"SD"</span>,</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_obs_Waitlist =</span> <span class="st">"N"</span>,</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">mean_lsas_Self-guided</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"M"</span>,</span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">sd_lsas_Self-guided</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"SD"</span>,</span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">n_obs_Self-guided</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"N"</span>,</span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">mean_lsas_Therapist-guided</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"M"</span>,</span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">sd_lsas_Therapist-guided</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"SD"</span>,</span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">n_obs_Therapist-guided</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"N"</span></span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"mean_"</span>) <span class="sc">|</span> <span class="fu">starts_with</span>(<span class="st">"sd_"</span>),</span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">2</span></span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"n_obs"</span>),</span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">0</span></span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sub_missing</span>(</span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>(),</span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">missing_text =</span> <span class="st">"—"</span></span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb64-42"><a href="#cb64-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Custom styling</span></span>
<span id="cb64-43"><a href="#cb64-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb64-44"><a href="#cb64-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.border.top.style =</span> <span class="st">"solid"</span>,</span>
<span id="cb64-45"><a href="#cb64-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.border.top.width =</span> <span class="fu">px</span>(<span class="dv">2</span>),</span>
<span id="cb64-46"><a href="#cb64-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.border.bottom.style =</span> <span class="st">"solid"</span>,</span>
<span id="cb64-47"><a href="#cb64-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.border.bottom.width =</span> <span class="fu">px</span>(<span class="dv">2</span>),</span>
<span id="cb64-48"><a href="#cb64-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.border.left.style =</span> <span class="st">"none"</span>,</span>
<span id="cb64-49"><a href="#cb64-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.border.right.style =</span> <span class="st">"none"</span>,</span>
<span id="cb64-50"><a href="#cb64-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.border.bottom.style =</span> <span class="st">"solid"</span>,</span>
<span id="cb64-51"><a href="#cb64-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.border.bottom.width =</span> <span class="fu">px</span>(<span class="dv">1</span>),</span>
<span id="cb64-52"><a href="#cb64-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.top.style =</span> <span class="st">"solid"</span>,</span>
<span id="cb64-53"><a href="#cb64-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.top.width =</span> <span class="fu">px</span>(<span class="dv">1</span>),</span>
<span id="cb64-54"><a href="#cb64-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.bottom.style =</span> <span class="st">"solid"</span>,</span>
<span id="cb64-55"><a href="#cb64-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.bottom.width =</span> <span class="fu">px</span>(<span class="dv">1</span>),</span>
<span id="cb64-56"><a href="#cb64-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">table_body.border.bottom.style =</span> <span class="st">"none"</span>,</span>
<span id="cb64-57"><a href="#cb64-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.font.size =</span> <span class="dv">12</span></span>
<span id="cb64-58"><a href="#cb64-58" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb64-59"><a href="#cb64-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb64-60"><a href="#cb64-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>),</span>
<span id="cb64-61"><a href="#cb64-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_spanners</span>()</span>
<span id="cb64-62"><a href="#cb64-62" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb64-63"><a href="#cb64-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb64-64"><a href="#cb64-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">align =</span> <span class="st">"center"</span>),</span>
<span id="cb64-65"><a href="#cb64-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>()</span>
<span id="cb64-66"><a href="#cb64-66" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb64-67"><a href="#cb64-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb64-68"><a href="#cb64-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">align =</span> <span class="st">"center"</span>),</span>
<span id="cb64-69"><a href="#cb64-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="at">columns =</span> <span class="sc">-</span>time_factor)</span>
<span id="cb64-70"><a href="#cb64-70" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb64-71"><a href="#cb64-71" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add table title and subtitle</span></span>
<span id="cb64-72"><a href="#cb64-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb64-73"><a href="#cb64-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 1"</span>,</span>
<span id="cb64-74"><a href="#cb64-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"LSAS Scores by Treatment Group and Time Point"</span></span>
<span id="cb64-75"><a href="#cb64-75" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb64-76"><a href="#cb64-76" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add table note</span></span>
<span id="cb64-77"><a href="#cb64-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(</span>
<span id="cb64-78"><a href="#cb64-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">source_note =</span> <span class="st">"Note. LSAS = Liebowitz Social Anxiety Scale; M = Mean; SD = Standard Deviation; N = Sample Size."</span></span>
<span id="cb64-79"><a href="#cb64-79" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb64-80"><a href="#cb64-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-81"><a href="#cb64-81" aria-hidden="true" tabindex="-1"></a>my_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="printltktn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#printltktn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#printltktn thead, #printltktn tbody, #printltktn tfoot, #printltktn tr, #printltktn td, #printltktn th {
  border-style: none;
}

#printltktn p {
  margin: 0;
  padding: 0;
}

#printltktn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#printltktn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#printltktn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#printltktn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#printltktn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#printltktn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #D3D3D3;
}

#printltktn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#printltktn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#printltktn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#printltktn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#printltktn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#printltktn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#printltktn .gt_spanner_row {
  border-bottom-style: hidden;
}

#printltktn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#printltktn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#printltktn .gt_from_md > :first-child {
  margin-top: 0;
}

#printltktn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#printltktn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#printltktn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#printltktn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#printltktn .gt_row_group_first td {
  border-top-width: 2px;
}

#printltktn .gt_row_group_first th {
  border-top-width: 2px;
}

#printltktn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#printltktn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#printltktn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#printltktn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#printltktn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#printltktn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#printltktn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#printltktn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#printltktn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#printltktn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#printltktn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#printltktn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#printltktn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#printltktn .gt_left {
  text-align: left;
}

#printltktn .gt_center {
  text-align: center;
}

#printltktn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#printltktn .gt_font_normal {
  font-weight: normal;
}

#printltktn .gt_font_bold {
  font-weight: bold;
}

#printltktn .gt_font_italic {
  font-style: italic;
}

#printltktn .gt_super {
  font-size: 65%;
}

#printltktn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#printltktn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#printltktn .gt_indent_1 {
  text-indent: 5px;
}

#printltktn .gt_indent_2 {
  text-indent: 10px;
}

#printltktn .gt_indent_3 {
  text-indent: 15px;
}

#printltktn .gt_indent_4 {
  text-indent: 20px;
}

#printltktn .gt_indent_5 {
  text-indent: 25px;
}

#printltktn .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#printltktn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="gt_heading header">
<th colspan="10" class="gt_heading gt_title gt_font_normal">Table 1</th>
</tr>
<tr class="gt_heading even">
<th colspan="10" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">LSAS Scores by Treatment Group and Time Point</th>
</tr>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" id="time_factor" class="gt_col_heading gt_columns_bottom_border gt_center" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">Time Point</th>
<th colspan="3" id="Therapist-guided" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold;" scope="colgroup"><div class="gt_column_spanner">
Therapist-guided
</div></th>
<th colspan="3" id="Self-guided" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold;" scope="colgroup"><div class="gt_column_spanner">
Self-guided
</div></th>
<th colspan="3" id="Waitlist" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" style="text-align: center; font-weight: bold;" scope="colgroup"><div class="gt_column_spanner">
Waitlist
</div></th>
</tr>
<tr class="gt_col_headings even">
<th id="mean_lsas_Therapist-guided" class="gt_col_heading gt_columns_bottom_border gt_right" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">M</th>
<th id="sd_lsas_Therapist-guided" class="gt_col_heading gt_columns_bottom_border gt_right" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">SD</th>
<th id="n_obs_Therapist-guided" class="gt_col_heading gt_columns_bottom_border gt_right" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">N</th>
<th id="mean_lsas_Self-guided" class="gt_col_heading gt_columns_bottom_border gt_right" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">M</th>
<th id="sd_lsas_Self-guided" class="gt_col_heading gt_columns_bottom_border gt_right" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">SD</th>
<th id="n_obs_Self-guided" class="gt_col_heading gt_columns_bottom_border gt_right" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">N</th>
<th id="mean_lsas_Waitlist" class="gt_col_heading gt_columns_bottom_border gt_right" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">M</th>
<th id="sd_lsas_Waitlist" class="gt_col_heading gt_columns_bottom_border gt_right" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">SD</th>
<th id="n_obs_Waitlist" class="gt_col_heading gt_columns_bottom_border gt_right" style="text-align: center;" data-quarto-table-cell-role="th" scope="col">N</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="time_factor">Baseline</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Therapist-guided">84.22</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Therapist-guided">16.95</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Therapist-guided">60</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Self-guided">83.08</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Self-guided">12.97</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Self-guided">61</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Waitlist">86.98</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Waitlist">18.99</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Waitlist">60</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="time_factor">Week 1</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Therapist-guided">78.27</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Therapist-guided">19.17</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Therapist-guided">59</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Self-guided">78.45</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Self-guided">14.41</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Self-guided">55</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Waitlist">83.47</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Waitlist">19.63</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Waitlist">58</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="time_factor">Week 2</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Therapist-guided">77.53</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Therapist-guided">20.79</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Therapist-guided">51</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Self-guided">78.37</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Self-guided">16.92</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Self-guided">52</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Waitlist">81.95</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Waitlist">22.48</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Waitlist">55</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="time_factor">Week 3</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Therapist-guided">75.67</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Therapist-guided">21.10</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Therapist-guided">48</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Self-guided">77.28</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Self-guided">18.22</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Self-guided">43</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Waitlist">80.27</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Waitlist">21.29</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Waitlist">51</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="time_factor">Week 4</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Therapist-guided">71.98</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Therapist-guided">19.13</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Therapist-guided">49</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Self-guided">71.24</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Self-guided">17.59</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Self-guided">41</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Waitlist">82.35</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Waitlist">24.01</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Waitlist">52</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="time_factor">Week 5</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Therapist-guided">68.91</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Therapist-guided">23.62</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Therapist-guided">45</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Self-guided">69.58</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Self-guided">20.87</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Self-guided">33</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Waitlist">81.02</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Waitlist">21.33</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Waitlist">46</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="time_factor">Week 6</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Therapist-guided">61.87</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Therapist-guided">20.90</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Therapist-guided">47</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Self-guided">67.81</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Self-guided">19.88</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Self-guided">36</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Waitlist">80.04</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Waitlist">25.35</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Waitlist">49</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="time_factor">Week 7</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Therapist-guided">61.75</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Therapist-guided">23.94</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Therapist-guided">48</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Self-guided">69.52</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Self-guided">21.46</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Self-guided">31</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Waitlist">77.98</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Waitlist">26.96</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Waitlist">44</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="time_factor">Week 8</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Therapist-guided">57.47</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Therapist-guided">21.82</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Therapist-guided">43</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Self-guided">67.13</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Self-guided">21.87</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Self-guided">30</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Waitlist">77.87</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Waitlist">25.72</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Waitlist">46</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="time_factor">Post-treatment</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Therapist-guided">57.35</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Therapist-guided">23.19</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Therapist-guided">54</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Self-guided">64.91</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Self-guided">21.08</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Self-guided">57</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Waitlist">78.45</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Waitlist">25.44</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Waitlist">58</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="time_factor">6-month follow-up</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Therapist-guided">56.42</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Therapist-guided">25.81</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Therapist-guided">53</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Self-guided">57.71</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Self-guided">21.98</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Self-guided">51</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Waitlist">—</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Waitlist">—</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Waitlist">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="time_factor">12-month follow-up</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Therapist-guided">55.71</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Therapist-guided">26.18</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Therapist-guided">52</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Self-guided">54.24</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Self-guided">25.15</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Self-guided">49</td>
<td class="gt_row gt_right" style="text-align: center;" headers="mean_lsas_Waitlist">—</td>
<td class="gt_row gt_right" style="text-align: center;" headers="sd_lsas_Waitlist">—</td>
<td class="gt_row gt_right" style="text-align: center;" headers="n_obs_Waitlist">0</td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="odd">
<td colspan="10" class="gt_sourcenote">Note. LSAS = Liebowitz Social Anxiety Scale; M = Mean; SD = Standard Deviation; N = Sample Size.</td>
</tr>
</tfoot>

</table>

</div>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gtsave</span>(my_table, <span class="st">"tables/my_table.docx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/biostatistics-psychiatry\.github\.io\/lab-materials\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../labs/descriptive-statistics.html" class="pagination-link" aria-label="Descriptive statistics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Descriptive statistics</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../labs/sampling.html" class="pagination-link" aria-label="Sampling from a population">
        <span class="nav-page-text">Sampling from a population</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/biostatistics-psychiatry/lab-materials/edit/main/labs/tidy-data-manipulation.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/biostatistics-psychiatry/lab-materials/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>