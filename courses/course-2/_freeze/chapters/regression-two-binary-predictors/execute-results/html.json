{
  "hash": "3c5befa20ffb816c6d27dfb402470147",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Chapter 5: Regression with Two Binary Predictors\"\nformat: \n   html:\n     df-print: kable\ntoc: true\ntoc-depth: 3\nnumber-sections: true\n---\n\n\n\n# Introduction\n\nIn the previous chapters, we studied regression models with:\n\n-   a single binary predictor\n-   a categorical predictor with multiple levels\n-   a numeric predictor\n\nIn this chapter, we extend these ideas to **two binary predictors**.\\\nThis allows us to introduce the important concept of **conditional effects** and to distinguish between:\n\n-   **additive models** (no interaction)\n-   **interaction models** (effect modification)\n\nYou will learn:\n\n-   how to interpret models with two binary predictors\n-   what *conditional effects* mean\n-   how interactions change interpretation\n-   how to estimate and visualize effects using `marginaleffects`\n-   how linear and quantile regression handle interactions\n\n# Packages and Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(broom)\nlibrary(quantreg)\nlibrary(marginaleffects)\nlibrary(here)\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n\n## Load data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_clean <- read_csv2(here(\"data\", \"steps_clean.csv\"))\n```\n:::\n\n\n\nOne of the predictors will be treatment group. To get a binary variable (i.e., one with only two levels), we subset the data to include only participants in the therapist-guided or wait-list conditions. We'll call this reduced dataset `df_red`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_red <- filter(df_clean, trt %in% c(\"therapist-guided\", \"waitlist\"))\n```\n:::\n\n\n\nWe convert `trt` to a factor and set `waitlist` as the reference group.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_red <- df_red |>\n  mutate(\n    trt = factor(trt, levels = c(\"waitlist\", \"therapist-guided\"))\n  )\n```\n:::\n\n\n\nThe other predictor will be depression severity. To get a binary variable, we dichotomize the PHQ-9 measure at screening using the sample median (for illustration only).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_red <- df_red |>\n  mutate(\n    dep_bin = factor(\n      phq9_screen > median(phq9_screen, na.rm = TRUE),\n      levels = c(FALSE, TRUE),\n      labels = c(\"Low\", \"High\")\n    )\n  )\n\ntable(df_red$dep_bin) # show distribution\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n Low High \n  65   55 \n```\n\n\n:::\n:::\n\n\n\n# Two Binary Predictors without Interaction (Additive Model)\n\nWe begin with a model that includes both predictors **without** an interaction.\n\n## Model formula\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlsas_post ~ trt + dep_bin\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nlsas_post ~ trt + dep_bin\n```\n\n\n:::\n:::\n\n\n\nThis corresponds to the linear regression model for the conditional mean:\n\n$$\n\\begin{aligned}\n\\mathbb{E}(LSAS_{post,i} \\,\\mid\\, trt_i,\\; dep\\_bin_i) =& \\beta_0 + \\\\\n& \\beta_1\\, \\mathbf{1}\\{\\text{trt}_i = \\text{therapist-guided}\\} + \\\\\n& \\beta_2\\, \\mathbf{1}\\{\\text{dep\\_bin}_i = \\text{High}\\}\n\\end{aligned}\n$$\n\nWhere:\n\n-   $\\beta_0$: mean outcome in the reference group (waitlist & Low depression)\n-   $\\beta_1$: conditional treatment effect, holding depression constant\n-   $\\beta_2$: conditional depression effect, holding treatment constant\n\n## Interpretation of conditional effects\n\nIn this model:\n\n-   the effect of treatment is assumed to be **the same** for low and high depression\n-   the effect of depression is assumed to be **the same** in both treatment groups\n\nThis is called an **additive model** (because the effects of the two predictors are added to each other). Under additivity, the treatment effect is assumed the same in Low and High depression groups, and the depression effect is assumed the same in both treatment groups.\n\n# Linear Regression without Interaction\n\n## Fit the model\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod_lm_add <- lm(lsas_post ~ trt + dep_bin, data = df_red)\nsummary(mod_lm_add)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = lsas_post ~ trt + dep_bin, data = df_red)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-67.546 -14.212  -1.262  15.377  66.023 \n\nCoefficients:\n                    Estimate Std. Error t value Pr(>|t|)    \n(Intercept)           74.623      3.870  19.281  < 2e-16 ***\ntrttherapist-guided  -20.646      4.576  -4.511 1.63e-05 ***\ndep_binHigh            7.923      4.592   1.725   0.0873 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 24.16 on 109 degrees of freedom\n  (8 observations deleted due to missingness)\nMultiple R-squared:  0.1823,\tAdjusted R-squared:  0.1673 \nF-statistic: 12.15 on 2 and 109 DF,  p-value: 1.727e-05\n```\n\n\n:::\n:::\n\n\n\n### Interpretation\n\n-   **Intercept**: mean LSAS at post-treatment in waitlist & low depression.\n-   **trt coefficient**: mean difference between therapist-guided and waitlist, adjusted for depression. The mean LSAS post score in the therapist-guided group is \\~21 points lower than in the waitlist group.\n-   **dep_bin coefficient**: mean difference between High and Low depression, adjusted for treatment. The mean LSAS post score in the Low-depression group is \\~8 points lower than in the High-depression group.\n\n## Predicted means by group\n\nWe can now use the `marginaleffects` package to get the estimated means for each of the four groups, i.e., the *conditional* estimated means.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\navg_predictions(mod_lm_add, by = c(\"trt\", \"dep_bin\"))\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script src=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.js\"></script>\n\n    <script>\n      // Create table-specific functions using external factory\n      const tableFns_t7w843qk09qe5acgumbr = TinyTable.createTableFunctions(\"tinytable_t7w843qk09qe5acgumbr\");\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: '4', j: 1 }, { i: '4', j: 2 }, { i: '4', j: 3 }, { i: '4', j: 4 }, { i: '4', j: 5 }, { i: '4', j: 6 }, { i: '4', j: 7 }, { i: '4', j: 8 } ], css_id: 'tinytable_css_b03l0u66ziuacwy1vrhb',}, \n          { positions: [ { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 }, { i: '0', j: 6 }, { i: '0', j: 7 }, { i: '0', j: 8 } ], css_id: 'tinytable_css_hv88pm1xx8m5cpa43up9',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  tableFns_t7w843qk09qe5acgumbr.styleCell(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.css\">\n    <style>\n    /* tinytable css entries after */\n    #tinytable_t7w843qk09qe5acgumbr td.tinytable_css_b03l0u66ziuacwy1vrhb, #tinytable_t7w843qk09qe5acgumbr th.tinytable_css_b03l0u66ziuacwy1vrhb {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    #tinytable_t7w843qk09qe5acgumbr td.tinytable_css_hv88pm1xx8m5cpa43up9, #tinytable_t7w843qk09qe5acgumbr th.tinytable_css_hv88pm1xx8m5cpa43up9 {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    </style>\n    <div class=\"container\">\n      <table class=\"tinytable\" id=\"tinytable_t7w843qk09qe5acgumbr\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        \n        <thead>\n              <tr>\n                <th scope=\"col\" data-row=\"0\" data-col=\"1\">trt</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"2\">dep_bin</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"3\">Estimate</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"4\">Std. Error</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"5\">z</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"6\">Pr(&gt;|z|)</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"7\">2.5 %</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"8\">97.5 %</th>\n              </tr>\n        </thead>\n        <tfoot><tr><td colspan='8'>Type: response\n</td></tr></tfoot>\n        <tbody>\n                <tr>\n                  <td data-row=\"1\" data-col=\"1\">waitlist</td>\n                  <td data-row=\"1\" data-col=\"2\">Low</td>\n                  <td data-row=\"1\" data-col=\"3\">74.6</td>\n                  <td data-row=\"1\" data-col=\"4\">3.87</td>\n                  <td data-row=\"1\" data-col=\"5\">19.3</td>\n                  <td data-row=\"1\" data-col=\"6\">&lt;0.001</td>\n                  <td data-row=\"1\" data-col=\"7\">67.0</td>\n                  <td data-row=\"1\" data-col=\"8\">82.2</td>\n                </tr>\n                <tr>\n                  <td data-row=\"2\" data-col=\"1\">waitlist</td>\n                  <td data-row=\"2\" data-col=\"2\">High</td>\n                  <td data-row=\"2\" data-col=\"3\">82.5</td>\n                  <td data-row=\"2\" data-col=\"4\">3.96</td>\n                  <td data-row=\"2\" data-col=\"5\">20.8</td>\n                  <td data-row=\"2\" data-col=\"6\">&lt;0.001</td>\n                  <td data-row=\"2\" data-col=\"7\">74.8</td>\n                  <td data-row=\"2\" data-col=\"8\">90.3</td>\n                </tr>\n                <tr>\n                  <td data-row=\"3\" data-col=\"1\">therapist-guided</td>\n                  <td data-row=\"3\" data-col=\"2\">Low</td>\n                  <td data-row=\"3\" data-col=\"3\">54.0</td>\n                  <td data-row=\"3\" data-col=\"4\">3.83</td>\n                  <td data-row=\"3\" data-col=\"5\">14.1</td>\n                  <td data-row=\"3\" data-col=\"6\">&lt;0.001</td>\n                  <td data-row=\"3\" data-col=\"7\">46.5</td>\n                  <td data-row=\"3\" data-col=\"8\">61.5</td>\n                </tr>\n                <tr>\n                  <td data-row=\"4\" data-col=\"1\">therapist-guided</td>\n                  <td data-row=\"4\" data-col=\"2\">High</td>\n                  <td data-row=\"4\" data-col=\"3\">61.9</td>\n                  <td data-row=\"4\" data-col=\"4\">4.21</td>\n                  <td data-row=\"4\" data-col=\"5\">14.7</td>\n                  <td data-row=\"4\" data-col=\"6\">&lt;0.001</td>\n                  <td data-row=\"4\" data-col=\"7\">53.6</td>\n                  <td data-row=\"4\" data-col=\"8\">70.2</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n\n## Treatment effect as a conditional contrast\n\nWe can get the conditional treatment effects across both groups using the `marginaleffects` package.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\navg_comparisons(mod_lm_add,\n  variables = \"trt\",\n  by = \"dep_bin\"\n)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script src=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.js\"></script>\n\n    <script>\n      // Create table-specific functions using external factory\n      const tableFns_bwwq5gzwok7ia098qh7b = TinyTable.createTableFunctions(\"tinytable_bwwq5gzwok7ia098qh7b\");\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: '2', j: 1 }, { i: '2', j: 2 }, { i: '2', j: 3 }, { i: '2', j: 4 }, { i: '2', j: 5 }, { i: '2', j: 6 }, { i: '2', j: 7 } ], css_id: 'tinytable_css_oas9u380b77ign3mcmf5',}, \n          { positions: [ { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 }, { i: '0', j: 6 }, { i: '0', j: 7 } ], css_id: 'tinytable_css_fxqqp5dw8cp1a7wirp9n',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  tableFns_bwwq5gzwok7ia098qh7b.styleCell(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.css\">\n    <style>\n    /* tinytable css entries after */\n    #tinytable_bwwq5gzwok7ia098qh7b td.tinytable_css_oas9u380b77ign3mcmf5, #tinytable_bwwq5gzwok7ia098qh7b th.tinytable_css_oas9u380b77ign3mcmf5 {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    #tinytable_bwwq5gzwok7ia098qh7b td.tinytable_css_fxqqp5dw8cp1a7wirp9n, #tinytable_bwwq5gzwok7ia098qh7b th.tinytable_css_fxqqp5dw8cp1a7wirp9n {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    </style>\n    <div class=\"container\">\n      <table class=\"tinytable\" id=\"tinytable_bwwq5gzwok7ia098qh7b\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        \n        <thead>\n              <tr>\n                <th scope=\"col\" data-row=\"0\" data-col=\"1\">dep_bin</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"2\">Estimate</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"3\">Std. Error</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"4\">z</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"5\">Pr(&gt;|z|)</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"6\">2.5 %</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"7\">97.5 %</th>\n              </tr>\n        </thead>\n        <tfoot><tr><td colspan='7'>Type: response\n</td></tr></tfoot>\n        <tbody>\n                <tr>\n                  <td data-row=\"1\" data-col=\"1\">Low</td>\n                  <td data-row=\"1\" data-col=\"2\">-20.6</td>\n                  <td data-row=\"1\" data-col=\"3\">4.58</td>\n                  <td data-row=\"1\" data-col=\"4\">-4.51</td>\n                  <td data-row=\"1\" data-col=\"5\">&lt;0.001</td>\n                  <td data-row=\"1\" data-col=\"6\">-29.6</td>\n                  <td data-row=\"1\" data-col=\"7\">-11.7</td>\n                </tr>\n                <tr>\n                  <td data-row=\"2\" data-col=\"1\">High</td>\n                  <td data-row=\"2\" data-col=\"2\">-20.6</td>\n                  <td data-row=\"2\" data-col=\"3\">4.58</td>\n                  <td data-row=\"2\" data-col=\"4\">-4.51</td>\n                  <td data-row=\"2\" data-col=\"5\">&lt;0.001</td>\n                  <td data-row=\"2\" data-col=\"6\">-29.6</td>\n                  <td data-row=\"2\" data-col=\"7\">-11.7</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n\nSince we specified the model as additive, the treatment effect is the same in both depression groups.\n\n## Treatment effect as a marginal contrast\n\nThe marginal contrast averages over the conditional contrasts. Since these are the same in this model, the marginal effect will be identical to the conditional effects.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\navg_comparisons(mod_lm_add, variables = \"trt\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script src=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.js\"></script>\n\n    <script>\n      // Create table-specific functions using external factory\n      const tableFns_63j8mq0afgn869eevi4c = TinyTable.createTableFunctions(\"tinytable_63j8mq0afgn869eevi4c\");\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: '1', j: 1 }, { i: '1', j: 2 }, { i: '1', j: 3 }, { i: '1', j: 4 }, { i: '1', j: 5 }, { i: '1', j: 6 } ], css_id: 'tinytable_css_lfeirsi8a0aw2cjl5qcw',}, \n          { positions: [ { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 }, { i: '0', j: 6 } ], css_id: 'tinytable_css_7es0vskk9bpy8r2jcuj6',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  tableFns_63j8mq0afgn869eevi4c.styleCell(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.css\">\n    <style>\n    /* tinytable css entries after */\n    #tinytable_63j8mq0afgn869eevi4c td.tinytable_css_lfeirsi8a0aw2cjl5qcw, #tinytable_63j8mq0afgn869eevi4c th.tinytable_css_lfeirsi8a0aw2cjl5qcw {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    #tinytable_63j8mq0afgn869eevi4c td.tinytable_css_7es0vskk9bpy8r2jcuj6, #tinytable_63j8mq0afgn869eevi4c th.tinytable_css_7es0vskk9bpy8r2jcuj6 {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    </style>\n    <div class=\"container\">\n      <table class=\"tinytable\" id=\"tinytable_63j8mq0afgn869eevi4c\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        \n        <thead>\n              <tr>\n                <th scope=\"col\" data-row=\"0\" data-col=\"1\">Estimate</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"2\">Std. Error</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"3\">z</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"4\">Pr(&gt;|z|)</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"5\">2.5 %</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"6\">97.5 %</th>\n              </tr>\n        </thead>\n        <tfoot><tr><td colspan='6'>Type: response\n</td></tr></tfoot>\n        <tbody>\n                <tr>\n                  <td data-row=\"1\" data-col=\"1\">-20.6</td>\n                  <td data-row=\"1\" data-col=\"2\">4.58</td>\n                  <td data-row=\"1\" data-col=\"3\">-4.51</td>\n                  <td data-row=\"1\" data-col=\"4\">&lt;0.001</td>\n                  <td data-row=\"1\" data-col=\"5\">-29.6</td>\n                  <td data-row=\"1\" data-col=\"6\">-11.7</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n\n# Adding an Interaction\n\nNow we allow the treatment effect to differ depending on depression severity.\n\n## Model formula with interaction\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlsas_post ~ trt * dep_bin\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nlsas_post ~ trt * dep_bin\n```\n\n\n:::\n:::\n\n\n\nWhich expands, using indicator functions, to the conditional mean:\n\n$$\n\\begin{aligned}\n\\mathbb{E}(LSAS_{post,i} \\,\\mid\\, trt_i,\\; dep\\_bin_i) =& \\beta_0 + \\\\\n& \\beta_1\\, \\mathbf{1}\\{\\text{trt}_i = \\text{therapist-guided}\\} + \\\\\n& \\beta_2\\, \\mathbf{1}\\{\\text{dep\\_bin}_i = \\text{High}\\} + \\\\\n& \\beta_3\\, \\mathbf{1}\\{\\text{trt}_i = \\text{therapist-guided}\\}\\times \\mathbf{1}\\{\\text{dep\\_bin}_i = \\text{High}\\}\n\\end{aligned}\n$$\n\n-   $\\beta_3$ is the **interaction term**\n-   it captures how the treatment effect changes with depression level\n\nWe now allow for different treatment effects **depending on the level of depression**, rather than the treatment effect simply adding to the depression effect as in the additive model.\n\n# Linear Regression with Interaction\n\n## Fit the interaction model\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod_lm_int <- lm(lsas_post ~ trt * dep_bin, data = df_red)\nsummary(mod_lm_int)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = lsas_post ~ trt * dep_bin, data = df_red)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-68.964 -13.517  -0.237  14.286  64.742 \n\nCoefficients:\n                                Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                       73.300      4.424  16.570  < 2e-16 ***\ntrttherapist-guided              -18.042      6.205  -2.907  0.00442 ** \ndep_binHigh                       10.664      6.367   1.675  0.09683 .  \ntrttherapist-guided:dep_binHigh   -5.748      9.220  -0.624  0.53427    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 24.23 on 108 degrees of freedom\n  (8 observations deleted due to missingness)\nMultiple R-squared:  0.1852,\tAdjusted R-squared:  0.1626 \nF-statistic: 8.183 on 3 and 108 DF,  p-value: 5.869e-05\n```\n\n\n:::\n:::\n\n\n\n### Interpretation\n\n-   The treatment effect is **conditional on depression severity**\n-   Main effects are now interpreted **at the reference level** of the other variable\n-   The interaction coefficient represents the **difference in the treatment effect between participants with high versus low depression**. It tells us that the treatment effect is \\~6 points greater in the high-depression group compared with the treatment effect in the low-depression group.\n\n## Conditional treatment effects\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\navg_comparisons(\n  mod_lm_int,\n  variables = \"trt\",\n  by = \"dep_bin\"\n)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script src=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.js\"></script>\n\n    <script>\n      // Create table-specific functions using external factory\n      const tableFns_vlu1j3jperh1uram7nnm = TinyTable.createTableFunctions(\"tinytable_vlu1j3jperh1uram7nnm\");\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: '2', j: 1 }, { i: '2', j: 2 }, { i: '2', j: 3 }, { i: '2', j: 4 }, { i: '2', j: 5 }, { i: '2', j: 6 }, { i: '2', j: 7 } ], css_id: 'tinytable_css_85dyqchn0k1jczvvres8',}, \n          { positions: [ { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 }, { i: '0', j: 6 }, { i: '0', j: 7 } ], css_id: 'tinytable_css_889gvpjpxnsq9ue8ni7u',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  tableFns_vlu1j3jperh1uram7nnm.styleCell(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.css\">\n    <style>\n    /* tinytable css entries after */\n    #tinytable_vlu1j3jperh1uram7nnm td.tinytable_css_85dyqchn0k1jczvvres8, #tinytable_vlu1j3jperh1uram7nnm th.tinytable_css_85dyqchn0k1jczvvres8 {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    #tinytable_vlu1j3jperh1uram7nnm td.tinytable_css_889gvpjpxnsq9ue8ni7u, #tinytable_vlu1j3jperh1uram7nnm th.tinytable_css_889gvpjpxnsq9ue8ni7u {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    </style>\n    <div class=\"container\">\n      <table class=\"tinytable\" id=\"tinytable_vlu1j3jperh1uram7nnm\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        \n        <thead>\n              <tr>\n                <th scope=\"col\" data-row=\"0\" data-col=\"1\">dep_bin</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"2\">Estimate</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"3\">Std. Error</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"4\">z</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"5\">Pr(&gt;|z|)</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"6\">2.5 %</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"7\">97.5 %</th>\n              </tr>\n        </thead>\n        <tfoot><tr><td colspan='7'>Type: response\n</td></tr></tfoot>\n        <tbody>\n                <tr>\n                  <td data-row=\"1\" data-col=\"1\">Low</td>\n                  <td data-row=\"1\" data-col=\"2\">-18.0</td>\n                  <td data-row=\"1\" data-col=\"3\">6.21</td>\n                  <td data-row=\"1\" data-col=\"4\">-2.91</td>\n                  <td data-row=\"1\" data-col=\"5\">0.00364</td>\n                  <td data-row=\"1\" data-col=\"6\">-30.2</td>\n                  <td data-row=\"1\" data-col=\"7\">-5.88</td>\n                </tr>\n                <tr>\n                  <td data-row=\"2\" data-col=\"1\">High</td>\n                  <td data-row=\"2\" data-col=\"2\">-23.8</td>\n                  <td data-row=\"2\" data-col=\"3\">6.82</td>\n                  <td data-row=\"2\" data-col=\"4\">-3.49</td>\n                  <td data-row=\"2\" data-col=\"5\">&lt; 0.001</td>\n                  <td data-row=\"2\" data-col=\"6\">-37.2</td>\n                  <td data-row=\"2\" data-col=\"7\">-10.43</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n\nThese estimates answer:\n\n> What is the treatment effect **within each level of depression severity** (low vs high)?\n\nIn this interaction model, the treatment effect is allowed to differ depending on baseline depression.\n\n## Marginal treatment effects\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\navg_comparisons(\n  mod_lm_int,\n  variables = \"trt\"\n)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script src=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.js\"></script>\n\n    <script>\n      // Create table-specific functions using external factory\n      const tableFns_d8x0ld4jp14cmb42j6s5 = TinyTable.createTableFunctions(\"tinytable_d8x0ld4jp14cmb42j6s5\");\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: '1', j: 1 }, { i: '1', j: 2 }, { i: '1', j: 3 }, { i: '1', j: 4 }, { i: '1', j: 5 }, { i: '1', j: 6 } ], css_id: 'tinytable_css_fyx70ovunflu7mv0al7x',}, \n          { positions: [ { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 }, { i: '0', j: 6 } ], css_id: 'tinytable_css_lvmn8jk23tkh7g1qidir',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  tableFns_d8x0ld4jp14cmb42j6s5.styleCell(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.css\">\n    <style>\n    /* tinytable css entries after */\n    #tinytable_d8x0ld4jp14cmb42j6s5 td.tinytable_css_fyx70ovunflu7mv0al7x, #tinytable_d8x0ld4jp14cmb42j6s5 th.tinytable_css_fyx70ovunflu7mv0al7x {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    #tinytable_d8x0ld4jp14cmb42j6s5 td.tinytable_css_lvmn8jk23tkh7g1qidir, #tinytable_d8x0ld4jp14cmb42j6s5 th.tinytable_css_lvmn8jk23tkh7g1qidir {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    </style>\n    <div class=\"container\">\n      <table class=\"tinytable\" id=\"tinytable_d8x0ld4jp14cmb42j6s5\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        \n        <thead>\n              <tr>\n                <th scope=\"col\" data-row=\"0\" data-col=\"1\">Estimate</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"2\">Std. Error</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"3\">z</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"4\">Pr(&gt;|z|)</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"5\">2.5 %</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"6\">97.5 %</th>\n              </tr>\n        </thead>\n        <tfoot><tr><td colspan='6'>Type: response\n</td></tr></tfoot>\n        <tbody>\n                <tr>\n                  <td data-row=\"1\" data-col=\"1\">-20.7</td>\n                  <td data-row=\"1\" data-col=\"2\">4.59</td>\n                  <td data-row=\"1\" data-col=\"3\">-4.5</td>\n                  <td data-row=\"1\" data-col=\"4\">&lt;0.001</td>\n                  <td data-row=\"1\" data-col=\"5\">-29.7</td>\n                  <td data-row=\"1\" data-col=\"6\">-11.7</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n\nThis estimate is the **marginal (population-average) treatment effect.** It is obtained by averaging the conditional treatment effects over the observed distribution of low and high depression in the sample. Because we allowed the effect to differ between the depression groups, this estimate is no longer identical to the conditional estimate of `trt` from the model, or to the conditional contrasts above.\n\n# Quantile Regression with Two Binary Predictors\n\nNow let's do the same thing with quantile regression.\n\n## Additive model (median differences)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod_rq_add <- rq(\n  lsas_post ~ trt + dep_bin,\n  tau = 0.5,\n  data = df_red\n)\nsummary(mod_rq_add)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall: rq(formula = lsas_post ~ trt + dep_bin, tau = 0.5, data = df_red)\n\ntau: [1] 0.5\n\nCoefficients:\n                    coefficients lower bd  upper bd \n(Intercept)          74.00000     61.64348  81.35652\ntrttherapist-guided -24.00000    -32.87924 -14.24152\ndep_binHigh          10.00000     -4.86453  16.86453\n```\n\n\n:::\n:::\n\n\n\n## Interaction model (median differences)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod_rq_int <- rq(\n  lsas_post ~ trt * dep_bin,\n  tau = 0.5,\n  data = df_red\n)\nsummary(mod_rq_int)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall: rq(formula = lsas_post ~ trt * dep_bin, tau = 0.5, data = df_red)\n\ntau: [1] 0.5\n\nCoefficients:\n                                coefficients lower bd  upper bd \n(Intercept)                      74.00000     68.36922  78.54359\ntrttherapist-guided             -22.00000    -30.47806 -10.56581\ndep_binHigh                      12.00000     -2.15693  20.25540\ntrttherapist-guided:dep_binHigh -11.00000    -22.36022  11.36022\n```\n\n\n:::\n:::\n\n\n\n## Conditional median treatment effects\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\navg_comparisons(\n  mod_rq_int,\n  variables = \"trt\",\n  by = \"dep_bin\"\n)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script src=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.js\"></script>\n\n    <script>\n      // Create table-specific functions using external factory\n      const tableFns_pm994j2g78lha8d1mb6o = TinyTable.createTableFunctions(\"tinytable_pm994j2g78lha8d1mb6o\");\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: '2', j: 1 }, { i: '2', j: 2 }, { i: '2', j: 3 }, { i: '2', j: 4 }, { i: '2', j: 5 }, { i: '2', j: 6 }, { i: '2', j: 7 } ], css_id: 'tinytable_css_gej39adevojggzhgdmwo',}, \n          { positions: [ { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 }, { i: '0', j: 6 }, { i: '0', j: 7 } ], css_id: 'tinytable_css_s5x0pgndvfxpdlpytszz',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  tableFns_pm994j2g78lha8d1mb6o.styleCell(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.css\">\n    <style>\n    /* tinytable css entries after */\n    #tinytable_pm994j2g78lha8d1mb6o td.tinytable_css_gej39adevojggzhgdmwo, #tinytable_pm994j2g78lha8d1mb6o th.tinytable_css_gej39adevojggzhgdmwo {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    #tinytable_pm994j2g78lha8d1mb6o td.tinytable_css_s5x0pgndvfxpdlpytszz, #tinytable_pm994j2g78lha8d1mb6o th.tinytable_css_s5x0pgndvfxpdlpytszz {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    </style>\n    <div class=\"container\">\n      <table class=\"tinytable\" id=\"tinytable_pm994j2g78lha8d1mb6o\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        \n        <thead>\n              <tr>\n                <th scope=\"col\" data-row=\"0\" data-col=\"1\">dep_bin</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"2\">Estimate</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"3\">Std. Error</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"4\">z</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"5\">Pr(&gt;|z|)</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"6\">2.5 %</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"7\">97.5 %</th>\n              </tr>\n        </thead>\n        <tfoot><tr><td colspan='7'>Type: response\n</td></tr></tfoot>\n        <tbody>\n                <tr>\n                  <td data-row=\"1\" data-col=\"1\">Low</td>\n                  <td data-row=\"1\" data-col=\"2\">-22</td>\n                  <td data-row=\"1\" data-col=\"3\">5.60</td>\n                  <td data-row=\"1\" data-col=\"4\">-3.93</td>\n                  <td data-row=\"1\" data-col=\"5\">&lt;0.001</td>\n                  <td data-row=\"1\" data-col=\"6\">-33.0</td>\n                  <td data-row=\"1\" data-col=\"7\">-11.0</td>\n                </tr>\n                <tr>\n                  <td data-row=\"2\" data-col=\"1\">High</td>\n                  <td data-row=\"2\" data-col=\"2\">-33</td>\n                  <td data-row=\"2\" data-col=\"3\">9.77</td>\n                  <td data-row=\"2\" data-col=\"4\">-3.38</td>\n                  <td data-row=\"2\" data-col=\"5\">&lt;0.001</td>\n                  <td data-row=\"2\" data-col=\"6\">-52.2</td>\n                  <td data-row=\"2\" data-col=\"7\">-13.8</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n\n## Marginal median treatment effects\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\navg_comparisons(\n  mod_rq_int,\n  variables = \"trt\"\n)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script src=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.js\"></script>\n\n    <script>\n      // Create table-specific functions using external factory\n      const tableFns_37snps1i0g24jy7cwgf4 = TinyTable.createTableFunctions(\"tinytable_37snps1i0g24jy7cwgf4\");\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: '1', j: 1 }, { i: '1', j: 2 }, { i: '1', j: 3 }, { i: '1', j: 4 }, { i: '1', j: 5 }, { i: '1', j: 6 } ], css_id: 'tinytable_css_l82y22pk122rcpcm9yt0',}, \n          { positions: [ { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 }, { i: '0', j: 6 } ], css_id: 'tinytable_css_uvgcriu3afm04k6qdigk',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  tableFns_37snps1i0g24jy7cwgf4.styleCell(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.css\">\n    <style>\n    /* tinytable css entries after */\n    #tinytable_37snps1i0g24jy7cwgf4 td.tinytable_css_l82y22pk122rcpcm9yt0, #tinytable_37snps1i0g24jy7cwgf4 th.tinytable_css_l82y22pk122rcpcm9yt0 {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    #tinytable_37snps1i0g24jy7cwgf4 td.tinytable_css_uvgcriu3afm04k6qdigk, #tinytable_37snps1i0g24jy7cwgf4 th.tinytable_css_uvgcriu3afm04k6qdigk {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    </style>\n    <div class=\"container\">\n      <table class=\"tinytable\" id=\"tinytable_37snps1i0g24jy7cwgf4\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        \n        <thead>\n              <tr>\n                <th scope=\"col\" data-row=\"0\" data-col=\"1\">Estimate</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"2\">Std. Error</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"3\">z</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"4\">Pr(&gt;|z|)</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"5\">2.5 %</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"6\">97.5 %</th>\n              </tr>\n        </thead>\n        <tfoot><tr><td colspan='6'>Type: response\n</td></tr></tfoot>\n        <tbody>\n                <tr>\n                  <td data-row=\"1\" data-col=\"1\">-27</td>\n                  <td data-row=\"1\" data-col=\"2\">5.4</td>\n                  <td data-row=\"1\" data-col=\"3\">-5.01</td>\n                  <td data-row=\"1\" data-col=\"4\">&lt;0.001</td>\n                  <td data-row=\"1\" data-col=\"5\">-37.6</td>\n                  <td data-row=\"1\" data-col=\"6\">-16.4</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n\n# Visualization\n\n## Group means (additive vs interaction model)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np_add <- plot_predictions(\n  mod_lm_add,\n  by = c(\"trt\", \"dep_bin\")\n) +\n  geom_line(\n    aes(trt, estimate, group = dep_bin, color = dep_bin),\n    position = position_dodge(0.1)\n  ) +\n  labs(\n    x = \"Treatment group\",\n    y = \"Estimated Mean LSAS (95% CI)\",\n    color = \"Depression\",\n    title = \"Additive Model\"\n  ) +\n  ylim(40, 95) +\n  theme_minimal()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(patchwork)\np_int <- plot_predictions(\n  mod_lm_int,\n  by = c(\"trt\", \"dep_bin\")\n) +\n  geom_line(\n    aes(trt, estimate, group = dep_bin, color = dep_bin),\n    position = position_dodge(0.1)\n  ) +\n  labs(\n    x = \"Treatment group\",\n    y = \"Estimated Mean LSAS (95% CI)\",\n    color = \"Depression\",\n    title = \"Interaction Model\"\n  ) +\n  ylim(40, 95) +\n  theme_minimal()\n\np_add + p_int + plot_layout(guides = \"collect\", axes = \"collect\")\n```\n\n::: {.cell-output-display}\n![](regression-two-binary-predictors_files/figure-html/plot-means-interaction-1.png){width=960}\n:::\n:::\n\n\n\nHere we see the difference between the additive and the interaction model clearly. Since the additive model assumed additivity, the lines are exactly parallel (i.e., the treatment effect is the same for the low vs high depression group). In the interaction model, we have allowed the treatment effects to differ by depression level, and we see that the high-depression group improves more than the low depression group.\n\n# Summary\n\nIn this chapter you learned:\n\n-   how to fit regression models with **two binary predictors**\n-   the meaning of **conditional effects**\n-   the difference between additive and interaction models\n-   how interactions change coefficient interpretation\n-   how to estimate conditional effects using `marginaleffects`\n-   how to visualize interactions using predicted values\n\nThis chapter completes the foundation for understanding **effect modification**, which is essential for applied regression and causal interpretation.\n",
    "supporting": [
      "regression-two-binary-predictors_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}